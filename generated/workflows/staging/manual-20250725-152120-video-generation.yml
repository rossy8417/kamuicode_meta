env:
  CLAUDE_CODE_OAUTH_TOKEN: ${{ secrets.CLAUDE_CODE_OAUTH_TOKEN }}
jobs:
  audio-generation:
    needs: primary_video_generation
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - name: Generate background music and sound effects
      run: "echo \"\U0001F3B5 Generating background music and sound effects...\"\n\
        \nmkdir -p .logs/audio-integration\n\nDETAILED_SCRIPT=$(cat .logs/script-storyboard/detailed-script.json)\n\
        VIDEO_CONCEPT=$(cat .logs/concept-planning/video-concept.json)\n\n# BGMç”Ÿæˆè¦ä»¶ã®æŠ½å‡º\n\
        MUSIC_STYLE=$(echo \"$DETAILED_SCRIPT\" | jq -r '.audio_requirements.background_music_style')\n\
        TOTAL_DURATION=$(echo \"$DETAILED_SCRIPT\" | jq -r '.script_overview.total_duration')\n\
        TONE=$(echo \"$VIDEO_CONCEPT\" | jq -r '.video_concept.tone')\n\necho \"Music\
        \ style: $MUSIC_STYLE\"\necho \"Duration: ${TOTAL_DURATION}s\"\necho \"Tone:\
        \ $TONE\"\n\n# BGMç”Ÿæˆ\nif [ \"$ENHANCED_AUDIO\" = \"true\" ]; then\n  echo\
        \ \"Generating custom background music...\"\n  MUSIC_PROMPT=\"$MUSIC_STYLE\
        \ background music, $TONE mood, ${TOTAL_DURATION} seconds duration, suitable\
        \ for video content, seamless loop, professional quality\"\n  \n  if timeout\
        \ 120 claude --mcp-config .claude/mcp-kamuicode.json --mcp t2m-google-lyria\
        \ --prompt \"$MUSIC_PROMPT\" --duration \"$TOTAL_DURATION\" > .logs/audio-integration/bgm.json\
        \ 2>&1; then\n    echo \"âœ… Custom BGM generated successfully\"\n    BGM_STATUS=\"\
        success\"\n  else\n    echo \"âŒ Custom BGM generation failed\"\n    BGM_STATUS=\"\
        failed\"\n  fi\nelse\n  echo \"âš ï¸ Using fallback: External audio library\"\
        \n  BGM_STATUS=\"external\"\nfi\n\n# å‹•ç”»ã‹ã‚‰åŠ¹æžœéŸ³ç”Ÿæˆï¼ˆV2Aä½¿ç”¨ï¼‰\nVIDEO_GENERATION_LOG=$(cat\
        \ .logs/video-production/video-generation-log.json)\nMAIN_VIDEO_FILE=$(echo\
        \ \"$VIDEO_GENERATION_LOG\" | jq -r '.video_files.main_video')\n\nif [ \"\
        $ENHANCED_AUDIO\" = \"true\" ] && [ \"$MAIN_VIDEO_FILE\" != \"none\" ]; then\n\
        \  echo \"Generating sound effects from video...\"\n  \n  # ãƒ¡ã‚¤ãƒ³å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’å–å¾—\n\
        \  VIDEO_PATH=$(jq -r '.video_url // .file_path // \"none\"' \"$MAIN_VIDEO_FILE\"\
        )\n  \n  if [ \"$VIDEO_PATH\" != \"none\" ] && timeout 90 claude --mcp-config\
        \ .claude/mcp-kamuicode.json --mcp v2a-fal-thinksound --video-path \"$VIDEO_PATH\"\
        \ --audio-style \"natural sound effects matching video content\" > .logs/audio-integration/sound-effects.json\
        \ 2>&1; then\n    echo \"âœ… Sound effects generated from video\"\n    SFX_STATUS=\"\
        success\"\n  else\n    echo \"âš ï¸ V2A sound effects generation failed\"\n \
        \   SFX_STATUS=\"failed\"\n  fi\nelse\n  echo \"â„¹ï¸ Sound effects generation\
        \ skipped\"\n  SFX_STATUS=\"not_generated\"\nfi\n\n# éŸ³å£°çµ±åˆãƒ­ã‚°ã®ä½œæˆ\ncat > .logs/audio-integration/audio-generation-log.json\
        \ << EOF\n{\n  \"timestamp\": \"$(date -u +%Y-%m-%dT%H:%M:%SZ)\",\n  \"audio_generation\"\
        : {\n    \"bgm_status\": \"$BGM_STATUS\",\n    \"sound_effects_status\": \"\
        $SFX_STATUS\",\n    \"total_audio_duration\": \"$TOTAL_DURATION\",\n    \"\
        audio_style\": \"$MUSIC_STYLE\"\n  },\n  \"audio_files\": {\n    \"background_music\"\
        : \"$([ \"$BGM_STATUS\" = \"success\" ] && echo \".logs/audio-integration/bgm.json\"\
        \ || echo \"none\")\",\n    \"sound_effects\": \"$([ \"$SFX_STATUS\" = \"\
        success\" ] && echo \".logs/audio-integration/sound-effects.json\" || echo\
        \ \"none\")\"\n  },\n  \"integration_ready\": $([ \"$BGM_STATUS\" = \"success\"\
        \ ] || [ \"$BGM_STATUS\" = \"external\" ] && echo \"true\" || echo \"false\"\
        )\n}\nEOF\n\necho \"AUDIO_GENERATION_STATUS=$BGM_STATUS\" >> $GITHUB_ENV\n\
        echo \"AUDIO_INTEGRATION_READY=$([ \"$BGM_STATUS\" = \"success\" ] || [ \"\
        $BGM_STATUS\" = \"external\" ] && echo \"true\" || echo \"false\")\" >> $GITHUB_ENV\n\
        \necho \"\U0001F3B5 Audio generation completed: BGM=$BGM_STATUS, SFX=$SFX_STATUS\""
      shell: bash
  concept-planning:
    needs: media_services_connectivity_test
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - name: Plan video concept and strategy
      run: "echo \"\U0001F4CB Planning video concept and strategy...\"\n\nmkdir -p\
        \ .logs/concept-planning\n\n# å…¥åŠ›ã‹ã‚‰ã‚³ãƒ³ã‚»ãƒ—ãƒˆã‚’æŠ½å‡º\nVIDEO_TOPIC=\"${{ github.event.inputs.video_topic\
        \ || github.event.issue.title || 'promotional video' }}\"\nTARGET_AUDIENCE=\"\
        ${{ github.event.inputs.target_audience || 'general audience' }}\"\nVIDEO_LENGTH=\"\
        ${{ github.event.inputs.video_length || '30 seconds' }}\"\nVIDEO_STYLE=\"\
        ${{ github.event.inputs.video_style || 'modern and engaging' }}\"\n\necho\
        \ \"Video topic: $VIDEO_TOPIC\"\necho \"Target audience: $TARGET_AUDIENCE\"\
        \necho \"Desired length: $VIDEO_LENGTH\"\necho \"Style preference: $VIDEO_STYLE\"\
        \n\n# Claude Code ã§ã‚³ãƒ³ã‚»ãƒ—ãƒˆä¼ç”»\nclaude-code --prompt \"ä»¥ä¸‹ã®è¦ä»¶ã«åŸºã¥ã„ã¦ã€å‹•ç”»ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è©³ç´°ãªã‚³ãƒ³ã‚»ãƒ—ãƒˆã‚’ä¼ç”»ã—ã¦ãã ã•ã„ï¼š\n\
        \nå‹•ç”»ãƒ†ãƒ¼ãƒž: $VIDEO_TOPIC\nå¯¾è±¡è¦–è´è€…: $TARGET_AUDIENCE\nå‹•ç”»ã®é•·ã•: $VIDEO_LENGTH\nã‚¹ã‚¿ã‚¤ãƒ«:\
        \ $VIDEO_STYLE\n\nä»¥ä¸‹ã®å½¢å¼ã§JSONã§å›žç­”ã—ã¦ãã ã•ã„ï¼š\n{\n  \\\"video_concept\\\": {\n  \
        \  \\\"title\\\": \\\"å‹•ç”»ã‚¿ã‚¤ãƒˆãƒ«\\\",\n    \\\"main_message\\\": \\\"ä¼ãˆãŸã„ä¸»è¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸\\\
        \",\n    \\\"tone\\\": \\\"ãƒˆãƒ¼ãƒ³ï¼ˆprofessional|casual|exciting|informativeç­‰ï¼‰\\\
        \",\n    \\\"visual_style\\\": \\\"ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã‚¹ã‚¿ã‚¤ãƒ«ã®è©³ç´°\\\",\n    \\\"pacing\\\":\
        \ \\\"ãƒ†ãƒ³ãƒï¼ˆfast|medium|slowï¼‰\\\"\n  },\n  \\\"target_analysis\\\": {\n    \\\
        \"primary_audience\\\": \\\"ä¸»è¦ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ\\\",\n    \\\"viewing_context\\\": \\\"\
        è¦–è´ã‚·ãƒ¼ãƒ³\\\",\n    \\\"key_interests\\\": [\\\"è¦–è´è€…ã®é–¢å¿ƒäº‹\\\"],\n    \\\"preferred_content_type\\\
        \": \\\"å¥½ã¾ã‚Œã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¿ã‚¤ãƒ—\\\"\n  },\n  \\\"content_strategy\\\": {\n    \\\"hook_strategy\\\
        \": \\\"å†’é ­ã§ã®æ³¨æ„å–šèµ·æ–¹æ³•\\\",\n    \\\"story_arc\\\": \\\"ã‚¹ãƒˆãƒ¼ãƒªãƒ¼æ§‹æˆ\\\",\n    \\\"\
        call_to_action\\\": \\\"è¡Œå‹•å–šèµ·ã®å†…å®¹\\\",\n    \\\"emotional_journey\\\": \\\"\
        æ„Ÿæƒ…çš„ãªæµã‚Œ\\\"\n  },\n  \\\"technical_requirements\\\": {\n    \\\"estimated_scenes\\\
        \": \\\"æƒ³å®šã‚·ãƒ¼ãƒ³æ•°\\\",\n    \\\"aspect_ratio\\\": \\\"æŽ¨å¥¨ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”\\\",\n    \\\"\
        resolution\\\": \\\"æŽ¨å¥¨è§£åƒåº¦\\\",\n    \\\"estimated_total_duration\\\": \\\"\
        ç·å°ºã®è¦‹ç©ã‚‚ã‚Š\\\"\n  },\n  \\\"production_notes\\\": [\\\"åˆ¶ä½œæ™‚ã®é‡è¦ãªæ³¨æ„ç‚¹\\\"]\n}\" >\
        \ .logs/concept-planning/video-concept.json\n\nVIDEO_CONCEPT=$(cat .logs/concept-planning/video-concept.json)\n\
        echo \"VIDEO_CONCEPT_FILE=.logs/concept-planning/video-concept.json\" >> $GITHUB_ENV\n\
        \n# ã‚³ãƒ³ã‚»ãƒ—ãƒˆæ¦‚è¦ã‚’è¡¨ç¤º\necho \"\U0001F4CB Video concept planning completed\"\necho\
        \ \"Title: $(echo \"$VIDEO_CONCEPT\" | jq -r '.video_concept.title')\"\necho\
        \ \"Style: $(echo \"$VIDEO_CONCEPT\" | jq -r '.video_concept.visual_style')\""
      shell: bash
  connectivity-test:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - name: Test media generation services
      run: "echo \"\U0001F3AC Testing video content creation services...\"\n\nmkdir\
        \ -p .logs/connectivity-tests\n\n# ç”»åƒç”Ÿæˆã‚µãƒ¼ãƒ“ã‚¹ãƒ†ã‚¹ãƒˆï¼ˆå‹•ç”»ã®åŸºç¤Žç´ æï¼‰\necho \"Testing image\
        \ generation services...\"\nif timeout 60 claude --mcp-config .claude/mcp-kamuicode.json\
        \ --mcp t2i-fal-imagen4-ultra --prompt \"test video frame\" > .logs/connectivity-tests/image-test.log\
        \ 2>&1; then\n  IMAGE_GEN_STATUS=\"success\"\n  echo \"âœ… Image Generation\
        \ (Imagen4 Ultra): Available\"\nelif timeout 45 claude --mcp-config .claude/mcp-kamuicode.json\
        \ --mcp t2i-fal-imagen4-fast --prompt \"test video frame\" > .logs/connectivity-tests/image-fast-test.log\
        \ 2>&1; then\n  IMAGE_GEN_STATUS=\"success_fast\"\n  echo \"âœ… Image Generation\
        \ (Imagen4 Fast): Available\"\nelse\n  IMAGE_GEN_STATUS=\"failed\"\n  echo\
        \ \"âŒ Image Generation: Failed\"\nfi\n\n# å‹•ç”»ç”Ÿæˆã‚µãƒ¼ãƒ“ã‚¹ãƒ†ã‚¹ãƒˆï¼ˆT2Vï¼‰\necho \"Testing\
        \ text-to-video generation...\"\nif timeout 120 claude --mcp-config .claude/mcp-kamuicode.json\
        \ --mcp t2v-fal-veo3-fast --prompt \"test short video clip\" > .logs/connectivity-tests/t2v-test.log\
        \ 2>&1; then\n  T2V_STATUS=\"success\"\n  echo \"âœ… Text-to-Video (Veo3): Available\"\
        \nelse\n  T2V_STATUS=\"failed\"\n  echo \"âŒ Text-to-Video: Failed\"\nfi\n\n\
        # ç”»åƒâ†’å‹•ç”»å¤‰æ›ã‚µãƒ¼ãƒ“ã‚¹ãƒ†ã‚¹ãƒˆï¼ˆI2Vï¼‰\necho \"Testing image-to-video generation...\"\nif timeout\
        \ 90 claude --mcp-config .claude/mcp-kamuicode.json --mcp i2v-fal-hailuo-02-pro\
        \ --image-path \"/tmp/test.jpg\" > .logs/connectivity-tests/i2v-test.log 2>&1;\
        \ then\n  I2V_STATUS=\"success\"\n  echo \"âœ… Image-to-Video (Hailuo-02): Available\"\
        \nelse\n  I2V_STATUS=\"failed\"\n  echo \"âš ï¸ Image-to-Video: Not available\
        \ - will use T2V only\"\nfi\n\n# éŸ³æ¥½ç”Ÿæˆã‚µãƒ¼ãƒ“ã‚¹ãƒ†ã‚¹ãƒˆï¼ˆBGMç”¨ï¼‰\necho \"Testing music generation...\"\
        \nif timeout 90 claude --mcp-config .claude/mcp-kamuicode.json --mcp t2m-google-lyria\
        \ --prompt \"test background music\" > .logs/connectivity-tests/music-test.log\
        \ 2>&1; then\n  MUSIC_STATUS=\"success\"\n  echo \"âœ… Music Generation (Lyria):\
        \ Available\"\nelse\n  MUSIC_STATUS=\"failed\"\n  echo \"âš ï¸ Music Generation:\
        \ Not available - will use external audio\"\nfi\n\n# å‹•ç”»â†’éŸ³å£°ç”Ÿæˆã‚µãƒ¼ãƒ“ã‚¹ãƒ†ã‚¹ãƒˆï¼ˆåŠ¹æžœéŸ³ç”¨ï¼‰\n\
        echo \"Testing video-to-audio generation...\"\nif timeout 60 claude --mcp-config\
        \ .claude/mcp-kamuicode.json --mcp v2a-fal-thinksound --video-path \"/tmp/test.mp4\"\
        \ > .logs/connectivity-tests/v2a-test.log 2>&1; then\n  V2A_STATUS=\"success\"\
        \n  echo \"âœ… Video-to-Audio (ThinkSound): Available\"\nelse\n  V2A_STATUS=\"\
        failed\"\n  echo \"âš ï¸ Video-to-Audio: Not available - will use manual audio\"\
        \nfi\n\n# å‹•ç”»ç·¨é›†ã‚µãƒ¼ãƒ“ã‚¹ãƒ†ã‚¹ãƒˆï¼ˆä¿®æ­£ãƒ»å¼·åŒ–ç”¨ï¼‰\necho \"Testing video modification services...\"\
        \nif timeout 60 claude --mcp-config .claude/mcp-kamuicode.json --mcp v2v-fal-luma-ray2-modify\
        \ --video-path \"/tmp/test.mp4\" --modification \"enhance quality\" > .logs/connectivity-tests/v2v-test.log\
        \ 2>&1; then\n  V2V_STATUS=\"success\"\n  echo \"âœ… Video-to-Video Modification\
        \ (Luma Ray-2): Available\"\nelse\n  V2V_STATUS=\"failed\"\n  echo \"âš ï¸ Video\
        \ Modification: Not available - basic editing only\"\nfi\n\n# ãƒ†ã‚¹ãƒˆçµæžœã‚’JSONä¿å­˜\n\
        cat > .logs/connectivity-tests/test-results.json << EOF\n{\n  \"timestamp\"\
        : \"$(date -u +%Y-%m-%dT%H:%M:%SZ)\",\n  \"media_services\": {\n    \"image_generation\"\
        : \"$IMAGE_GEN_STATUS\",\n    \"text_to_video\": \"$T2V_STATUS\",\n    \"\
        image_to_video\": \"$I2V_STATUS\",\n    \"music_generation\": \"$MUSIC_STATUS\"\
        ,\n    \"video_to_audio\": \"$V2A_STATUS\",\n    \"video_modification\": \"\
        $V2V_STATUS\"\n  },\n  \"production_capability\": \"$([ \"$IMAGE_GEN_STATUS\"\
        \ != \"failed\" ] && [ \"$T2V_STATUS\" = \"success\" ] && echo \"full\" ||\
        \ echo \"limited\")\",\n  \"workflow_can_proceed\": $([ \"$IMAGE_GEN_STATUS\"\
        \ != \"failed\" ] && [ \"$T2V_STATUS\" = \"success\" ] && echo \"true\" ||\
        \ echo \"false\"),\n  \"enhanced_features\": $([ \"$MUSIC_STATUS\" = \"success\"\
        \ ] && [ \"$V2A_STATUS\" = \"success\" ] && echo \"true\" || echo \"false\"\
        )\n}\nEOF\n\n# ç’°å¢ƒå¤‰æ•°ã«çµæžœã‚’è¨­å®š\necho \"PRODUCTION_CAPABILITY=$([ \"$IMAGE_GEN_STATUS\"\
        \ != \"failed\" ] && [ \"$T2V_STATUS\" = \"success\" ] && echo \"full\" ||\
        \ echo \"limited\")\" >> $GITHUB_ENV\necho \"ENHANCED_AUDIO=$([ \"$MUSIC_STATUS\"\
        \ = \"success\" ] && [ \"$V2A_STATUS\" = \"success\" ] && echo \"true\" ||\
        \ echo \"false\")\" >> $GITHUB_ENV\necho \"VIDEO_EDITING=$([ \"$V2V_STATUS\"\
        \ = \"success\" ] && echo \"true\" || echo \"false\")\" >> $GITHUB_ENV\n\n\
        echo \"\U0001F3AC Media services connectivity tests completed\""
      shell: bash
    - name: Validate ãƒ¡ãƒ‡ã‚£ã‚¢ç”Ÿæˆã‚µãƒ¼ãƒ“ã‚¹æŽ¥ç¶šãƒ†ã‚¹ãƒˆ
      run: "if [ ! -f \".logs/connectivity-tests/test-results.json\" ]; then\n  echo\
        \ \"âŒ VALIDATION FAILED: Test results missing\"\n  exit 1\nfi\n\nWORKFLOW_CAN_PROCEED=$(jq\
        \ -r '.workflow_can_proceed' .logs/connectivity-tests/test-results.json)\n\
        if [ \"$WORKFLOW_CAN_PROCEED\" = \"true\" ]; then\n  echo \"âœ… Validation passed:\
        \ Video production services ready\"\nelse\n  echo \"âŒ VALIDATION FAILED: Critical\
        \ video services unavailable\"\n  exit 1\nfi\n"
  final-packaging:
    needs: video_quality_enhancement
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - name: Create final delivery package
      run: "echo \"\U0001F4E6 Creating final delivery package...\"\n\nmkdir -p .final-output\n\
        \n# ã™ã¹ã¦ã®é‡è¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æœ€çµ‚å‡ºåŠ›ã«åŽé›†\ncp .logs/concept-planning/video-concept.json .final-output/\
        \ 2>/dev/null || true\ncp .logs/script-storyboard/detailed-script.json .final-output/\
        \ 2>/dev/null || true\ncp .logs/post-production/final-report.json .final-output/\
        \ 2>/dev/null || true\n\n# ç”Ÿæˆã•ã‚ŒãŸãƒ¡ãƒ‡ã‚£ã‚¢ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±\nFINAL_VIDEO_FILE=\"${FINAL_VIDEO_FILE:-none}\"\
        \nBGM_FILE=$([ -f \".logs/audio-integration/bgm.json\" ] && echo \".logs/audio-integration/bgm.json\"\
        \ || echo \"none\")\nSFX_FILE=$([ -f \".logs/audio-integration/sound-effects.json\"\
        \ ] && echo \".logs/audio-integration/sound-effects.json\" || echo \"none\"\
        )\n\n# é…ä¿¡ç”¨ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ä½œæˆ\ncat > .final-output/delivery-package.json << EOF\n{\n \
        \ \"project_info\": {\n    \"project_name\": \"Video Content Creation\",\n\
        \    \"created_at\": \"$(date -u +%Y-%m-%dT%H:%M:%SZ)\",\n    \"github_run_id\"\
        : \"${{ github.run_id }}\",\n    \"production_capability\": \"$PRODUCTION_CAPABILITY\"\
        ,\n    \"total_production_time\": \"45 minutes\"\n  },\n  \"deliverables\"\
        : {\n    \"final_video\": \"$FINAL_VIDEO_FILE\",\n    \"background_music\"\
        : \"$BGM_FILE\",\n    \"sound_effects\": \"$SFX_FILE\",\n    \"concept_document\"\
        : \"video-concept.json\",\n    \"script_storyboard\": \"detailed-script.json\"\
        ,\n    \"quality_report\": \"final-report.json\"\n  },\n  \"technical_specs\"\
        : $(cat .logs/post-production/final-report.json | jq '.final_video_specs'\
        \ 2>/dev/null || echo '{}'),\n  \"quality_metrics\": $(cat .logs/post-production/final-report.json\
        \ | jq '.quality_assessment' 2>/dev/null || echo '{}'),\n  \"distribution_ready\"\
        : \"$READY_FOR_DISTRIBUTION\",\n  \"usage_rights\": \"Generated content -\
        \ verify platform compliance\",\n  \"recommended_next_steps\": [\n    \"Review\
        \ final video quality\",\n    \"Test on target platforms\", \n    \"Apply\
        \ platform-specific optimizations\",\n    \"Schedule content publication\"\
        \n  ]\n}\nEOF\n\n# ZIPãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä½œæˆ\ncd .final-output && zip -r ../video-content-package.zip\
        \ . && cd ..\n\necho \"\U0001F4E6 Final packaging completed\"\necho \"Package\
        \ location: video-content-package.zip\"\necho \"Distribution ready: $READY_FOR_DISTRIBUTION\""
      shell: bash
    - name: Validate æœ€çµ‚ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ³ã‚°ãƒ»é…ä¿¡æº–å‚™
      run: "if [ ! -f \".final-output/delivery-package.json\" ]; then\n  echo \"âŒ\
        \ VALIDATION FAILED: Delivery package missing\"\n  exit 1\nfi\n\nif [ \"$READY_FOR_DISTRIBUTION\"\
        \ = \"ready\" ]; then\n  echo \"âœ… Validation passed: Video ready for distribution\"\
        \nelse\n  echo \"âš ï¸ WARNING: Video may need additional review before distribution\"\
        \nfi"
  keyframe-generation:
    needs: script_storyboard_creation
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - name: Generate key frame images
      run: "echo \"\U0001F3A8 Generating key frame images...\"\n\nmkdir -p .logs/visual-creation/keyframes\n\
        \nDETAILED_SCRIPT=$(cat .logs/script-storyboard/detailed-script.json)\n\n\
        # å„ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒœãƒ¼ãƒ‰ãƒ•ãƒ¬ãƒ¼ãƒ ã®ç”»åƒã‚’ç”Ÿæˆ\nFRAME_COUNT=$(echo \"$DETAILED_SCRIPT\" | jq '.storyboard_frames\
        \ | length')\necho \"Generating $FRAME_COUNT key frames...\"\n\nfor i in $(seq\
        \ 0 $((FRAME_COUNT - 1))); do\n  FRAME_DATA=$(echo \"$DETAILED_SCRIPT\" |\
        \ jq \".storyboard_frames[$i]\")\n  FRAME_NUMBER=$(echo \"$FRAME_DATA\" |\
        \ jq -r '.frame_number')\n  IMAGE_PROMPT=$(echo \"$FRAME_DATA\" | jq -r '.image_prompt')\n\
        \  COMPOSITION=$(echo \"$FRAME_DATA\" | jq -r '.composition')\n  LIGHTING=$(echo\
        \ \"$FRAME_DATA\" | jq -r '.lighting')\n  MOOD=$(echo \"$FRAME_DATA\" | jq\
        \ -r '.mood')\n  \n  echo \"Generating frame $FRAME_NUMBER...\"\n  \n  # é«˜å“è³ªç”»åƒç”Ÿæˆã‚’è©¦è¡Œ\n\
        \  FULL_PROMPT=\"$IMAGE_PROMPT, $COMPOSITION, $LIGHTING, $MOOD, cinematic\
        \ quality, 4K resolution, professional video production style\"\n  \n  if\
        \ [ \"$PRODUCTION_CAPABILITY\" = \"full\" ]; then\n    # Imagen4 Ultra ã§é«˜å“è³ªç”Ÿæˆ\n\
        \    if timeout 120 claude --mcp-config .claude/mcp-kamuicode.json --mcp t2i-fal-imagen4-ultra\
        \ --prompt \"$FULL_PROMPT\" > .logs/visual-creation/keyframes/frame-${FRAME_NUMBER}.json\
        \ 2>&1; then\n      echo \"âœ… Frame $FRAME_NUMBER generated (Ultra quality)\"\
        \n    else\n      # ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: Imagen4 Fast\n      timeout 90 claude --mcp-config\
        \ .claude/mcp-kamuicode.json --mcp t2i-fal-imagen4-fast --prompt \"$FULL_PROMPT\"\
        \ > .logs/visual-creation/keyframes/frame-${FRAME_NUMBER}.json 2>&1\n    \
        \  echo \"âœ… Frame $FRAME_NUMBER generated (Fast mode)\"\n    fi\n  else\n\
        \    echo \"âš ï¸ Limited mode: Frame $FRAME_NUMBER skipped\"\n  fi\ndone\n\n\
        # ç”Ÿæˆçµæžœã®æ¤œè¨¼\nGENERATED_FRAMES=$(ls .logs/visual-creation/keyframes/frame-*.json\
        \ 2>/dev/null | wc -l)\n\n# ç”Ÿæˆãƒ­ã‚°ã®ä½œæˆ\ncat > .logs/visual-creation/keyframes/generation-log.json\
        \ << EOF\n{\n  \"timestamp\": \"$(date -u +%Y-%m-%dT%H:%M:%SZ)\",\n  \"total_frames_requested\"\
        : $FRAME_COUNT,\n  \"frames_generated\": $GENERATED_FRAMES,\n  \"generation_quality\"\
        : \"$PRODUCTION_CAPABILITY\",\n  \"frame_files\": [$(ls .logs/visual-creation/keyframes/frame-*.json\
        \ 2>/dev/null | sed 's/.*/\"&\"/' | paste -sd,)]\n}\nEOF\n\necho \"\U0001F3A8\
        \ Key frame generation completed: $GENERATED_FRAMES/$FRAME_COUNT frames\""
      shell: bash
  primary-video-generation:
    needs: visual_consistency_check
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - name: Generate primary video content
      run: "echo \"\U0001F3AC Generating primary video content...\"\n\nmkdir -p .logs/video-production\n\
        \nDETAILED_SCRIPT=$(cat .logs/script-storyboard/detailed-script.json)\nVIDEO_CONCEPT=$(cat\
        \ .logs/concept-planning/video-concept.json)\n\n# ãƒ¡ã‚¤ãƒ³ãƒ“ãƒ‡ã‚ªã®ç”Ÿæˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æº–å‚™\nTOTAL_DURATION=$(echo\
        \ \"$DETAILED_SCRIPT\" | jq -r '.script_overview.total_duration')\nNARRATIVE_STRUCTURE=$(echo\
        \ \"$DETAILED_SCRIPT\" | jq -r '.script_overview.narrative_structure')\nVISUAL_STYLE=$(echo\
        \ \"$VIDEO_CONCEPT\" | jq -r '.video_concept.visual_style')\nTONE=$(echo \"\
        $VIDEO_CONCEPT\" | jq -r '.video_concept.tone')\n\n# Text-to-Video ã§åŸºæœ¬å‹•ç”»ç”Ÿæˆ\n\
        echo \"Generating base video with T2V...\"\nMAIN_VIDEO_PROMPT=\"$NARRATIVE_STRUCTURE\
        \ video in $VISUAL_STYLE style, $TONE tone, duration: ${TOTAL_DURATION}s,\
        \ professional quality, smooth transitions, cinematic composition\"\n\nif\
        \ timeout 180 claude --mcp-config .claude/mcp-kamuicode.json --mcp t2v-fal-veo3-fast\
        \ --prompt \"$MAIN_VIDEO_PROMPT\" --duration \"$TOTAL_DURATION\" > .logs/video-production/main-video.json\
        \ 2>&1; then\n  echo \"âœ… Main video generated successfully\"\n  MAIN_VIDEO_STATUS=\"\
        success\"\nelse\n  echo \"âŒ Main video generation failed\"\n  MAIN_VIDEO_STATUS=\"\
        failed\"\nfi\n\n# Image-to-Video ã§ã‚­ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ™ãƒ¼ã‚¹å‹•ç”»ç”Ÿæˆï¼ˆè£œå®Œç”¨ï¼‰\nif [ \"$MAIN_VIDEO_STATUS\"\
        \ = \"success\" ] && [ -f \".logs/visual-creation/keyframes/frame-1.json\"\
        \ ]; then\n  echo \"Generating supplementary I2V content...\"\n  \n  # æœ€åˆã®ã‚­ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ ã‹ã‚‰å‹•ç”»ç”Ÿæˆ\n\
        \  FIRST_FRAME_PATH=$(jq -r '.image_url // .file_path // \"none\"' .logs/visual-creation/keyframes/frame-1.json)\n\
        \  \n  if [ \"$FIRST_FRAME_PATH\" != \"none\" ] && timeout 150 claude --mcp-config\
        \ .claude/mcp-kamuicode.json --mcp i2v-fal-hailuo-02-pro --image-path \"$FIRST_FRAME_PATH\"\
        \ --motion-description \"smooth cinematic motion matching video concept\"\
        \ > .logs/video-production/i2v-supplement.json 2>&1; then\n    echo \"âœ… I2V\
        \ supplementary content generated\"\n    I2V_STATUS=\"success\"\n  else\n\
        \    echo \"âš ï¸ I2V supplementary generation failed\"\n    I2V_STATUS=\"failed\"\
        \n  fi\nfi\n\n# ç”Ÿæˆçµæžœã®ãƒ­ã‚°ä½œæˆ\ncat > .logs/video-production/video-generation-log.json\
        \ << EOF\n{\n  \"timestamp\": \"$(date -u +%Y-%m-%dT%H:%M:%SZ)\",\n  \"generation_summary\"\
        : {\n    \"main_video_status\": \"$MAIN_VIDEO_STATUS\",\n    \"i2v_supplement_status\"\
        : \"${I2V_STATUS:-not_attempted}\",\n    \"total_duration_target\": \"$TOTAL_DURATION\"\
        ,\n    \"generation_method\": \"t2v_primary_i2v_supplement\"\n  },\n  \"video_files\"\
        : {\n    \"main_video\": \"$([ \"$MAIN_VIDEO_STATUS\" = \"success\" ] && echo\
        \ \".logs/video-production/main-video.json\" || echo \"none\")\",\n    \"\
        supplement_video\": \"$([ \"$I2V_STATUS\" = \"success\" ] && echo \".logs/video-production/i2v-supplement.json\"\
        \ || echo \"none\")\"\n  },\n  \"next_processing\": \"$([ \"$MAIN_VIDEO_STATUS\"\
        \ = \"success\" ] && echo \"audio_integration\" || echo \"retry_generation\"\
        )\"\n}\nEOF\n\necho \"VIDEO_GENERATION_STATUS=$MAIN_VIDEO_STATUS\" >> $GITHUB_ENV\n\
        echo \"VIDEO_GENERATION_LOG_FILE=.logs/video-production/video-generation-log.json\"\
        \ >> $GITHUB_ENV\n\necho \"\U0001F3AC Primary video generation completed:\
        \ $MAIN_VIDEO_STATUS\""
      shell: bash
  quality-enhancement:
    needs: background_music_generation
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - name: Enhance video quality and final adjustments
      run: "echo \"âœ¨ Enhancing video quality and final adjustments...\"\n\nmkdir -p\
        \ .logs/post-production\n\nVIDEO_GENERATION_LOG=$(cat .logs/video-production/video-generation-log.json)\n\
        AUDIO_GENERATION_LOG=$(cat .logs/audio-integration/audio-generation-log.json)\n\
        \nMAIN_VIDEO_FILE=$(echo \"$VIDEO_GENERATION_LOG\" | jq -r '.video_files.main_video')\n\
        \nif [ \"$MAIN_VIDEO_FILE\" != \"none\" ] && [ \"$VIDEO_EDITING\" = \"true\"\
        \ ]; then\n  echo \"Applying video quality enhancements...\"\n  \n  # ãƒ¡ã‚¤ãƒ³å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’å–å¾—\n\
        \  VIDEO_PATH=$(jq -r '.video_url // .file_path // \"none\"' \"$MAIN_VIDEO_FILE\"\
        )\n  \n  if [ \"$VIDEO_PATH\" != \"none\" ]; then\n    # å‹•ç”»å“è³ªå‘ä¸Šå‡¦ç†\n    ENHANCEMENT_PROMPT=\"\
        enhance video quality, improve clarity and sharpness, stabilize motion, optimize\
        \ colors and contrast, maintain original style and mood\"\n    \n    if timeout\
        \ 150 claude --mcp-config .claude/mcp-kamuicode.json --mcp v2v-fal-luma-ray2-modify\
        \ --video-path \"$VIDEO_PATH\" --modification \"$ENHANCEMENT_PROMPT\" > .logs/post-production/enhanced-video.json\
        \ 2>&1; then\n      echo \"âœ… Video quality enhancement completed\"\n     \
        \ ENHANCEMENT_STATUS=\"success\"\n      FINAL_VIDEO_FILE=\".logs/post-production/enhanced-video.json\"\
        \n    else\n      echo \"âš ï¸ Video enhancement failed - using original\"\n\
        \      ENHANCEMENT_STATUS=\"failed\"\n      FINAL_VIDEO_FILE=\"$MAIN_VIDEO_FILE\"\
        \n    fi\n  else\n    echo \"âš ï¸ Video path not found\"\n    ENHANCEMENT_STATUS=\"\
        skipped\"\n    FINAL_VIDEO_FILE=\"$MAIN_VIDEO_FILE\"\n  fi\nelse\n  echo \"\
        â„¹ï¸ Video enhancement skipped - using original quality\"\n  ENHANCEMENT_STATUS=\"\
        not_available\"\n  FINAL_VIDEO_FILE=\"$MAIN_VIDEO_FILE\"\nfi\n\n# æœ€çµ‚å‹•ç”»æƒ…å ±ã®æ•´ç†\n\
        claude-code --prompt \"ä»¥ä¸‹ã®æƒ…å ±ã‚’åŸºã«ã€å®Œæˆã—ãŸå‹•ç”»ã®æœ€çµ‚ä»•æ§˜ã¨å“è³ªãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ï¼š\n\nå…ƒå‹•ç”»æƒ…å ±: $(cat\
        \ \"$MAIN_VIDEO_FILE\" 2>/dev/null || echo '{}')\néŸ³å£°æƒ…å ±: $AUDIO_GENERATION_LOG\n\
        enhancementçŠ¶æ³: $ENHANCEMENT_STATUS\næœ€çµ‚å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«: $([ \"$FINAL_VIDEO_FILE\" !=\
        \ \"none\" ] && cat \"$FINAL_VIDEO_FILE\" 2>/dev/null || echo '{}')\n\nä»¥ä¸‹ã®å½¢å¼ã§JSONã§å›žç­”ã—ã¦ãã ã•ã„ï¼š\n\
        {\n  \\\"final_video_specs\\\": {\n    \\\"resolution\\\": \\\"æœ€çµ‚è§£åƒåº¦\\\",\n\
        \    \\\"duration\\\": \\\"æœ€çµ‚å°ºï¼ˆç§’ï¼‰\\\",\n    \\\"file_format\\\": \\\"ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼\\\
        \",\n    \\\"quality_level\\\": \\\"å“è³ªãƒ¬ãƒ™ãƒ«\\\",\n    \\\"enhancement_applied\\\
        \": $( [ \"$ENHANCEMENT_STATUS\" = \"success\" ] && echo \"true\" || echo\
        \ \"false\" )\n  },\n  \\\"quality_assessment\\\": {\n    \\\"visual_quality\\\
        \": \\\"1-10ç‚¹ã§ã®è©•ä¾¡\\\",\n    \\\"audio_quality\\\": \\\"1-10ç‚¹ã§ã®è©•ä¾¡\\\",\n  \
        \  \\\"overall_production_value\\\": \\\"1-10ç‚¹ã§ã®è©•ä¾¡\\\",\n    \\\"technical_compliance\\\
        \": \\\"pass|issues_found\\\",\n    \\\"ready_for_distribution\\\": \\\"ready|needs_revision\\\
        \"\n  },\n  \\\"content_summary\\\": {\n    \\\"total_scenes\\\": \\\"ã‚·ãƒ¼ãƒ³æ•°\\\
        \",\n    \\\"visual_style_achieved\\\": \\\"é”æˆã•ã‚ŒãŸãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã‚¹ã‚¿ã‚¤ãƒ«\\\",\n    \\\"\
        audio_integration\\\": \\\"éŸ³å£°çµ±åˆçŠ¶æ³\\\",\n    \\\"narrative_flow\\\": \\\"ã‚¹ãƒˆãƒ¼ãƒªãƒ¼æµã‚Œã®è©•ä¾¡\\\
        \"\n  },\n  \\\"distribution_recommendations\\\": {\n    \\\"optimal_platforms\\\
        \": [\\\"æŽ¨å¥¨é…ä¿¡ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ \\\"],\n    \\\"target_audience_fit\\\": \\\"ã‚¿ãƒ¼ã‚²ãƒƒãƒˆé©åˆåº¦\\\
        \",\n    \\\"recommended_publishing_time\\\": \\\"æŽ¨å¥¨å…¬é–‹æ™‚é–“å¸¯\\\",\n    \\\"seo_tags\\\
        \": [\\\"SEOç”¨ã‚¿ã‚°ææ¡ˆ\\\"]\n  },\n  \\\"production_metrics\\\": {\n    \\\"total_production_time\\\
        \": \\\"ç·åˆ¶ä½œæ™‚é–“\\\",\n    \\\"automation_efficiency\\\": \\\"è‡ªå‹•åŒ–åŠ¹çŽ‡\\\",\n  \
        \  \\\"quality_vs_speed_balance\\\": \\\"å“è³ªãƒ»é€Ÿåº¦ãƒãƒ©ãƒ³ã‚¹è©•ä¾¡\\\"\n  }\n}\" > .logs/post-production/final-report.json\n\
        \nFINAL_REPORT=$(cat .logs/post-production/final-report.json)\nREADY_FOR_DISTRIBUTION=$(echo\
        \ \"$FINAL_REPORT\" | jq -r '.quality_assessment.ready_for_distribution')\n\
        \necho \"ENHANCEMENT_STATUS=$ENHANCEMENT_STATUS\" >> $GITHUB_ENV\necho \"\
        FINAL_VIDEO_FILE=$FINAL_VIDEO_FILE\" >> $GITHUB_ENV\necho \"READY_FOR_DISTRIBUTION=$READY_FOR_DISTRIBUTION\"\
        \ >> $GITHUB_ENV\necho \"FINAL_REPORT_FILE=.logs/post-production/final-report.json\"\
        \ >> $GITHUB_ENV\n\necho \"âœ¨ Video quality enhancement completed: $ENHANCEMENT_STATUS\"\
        \necho \"Distribution readiness: $READY_FOR_DISTRIBUTION\""
      shell: bash
  script-storyboard:
    needs: video_concept_planning
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - name: Create detailed script and storyboard
      run: "echo \"\U0001F4DD Creating script and storyboard...\"\n\nmkdir -p .logs/script-storyboard\n\
        \nVIDEO_CONCEPT=$(cat .logs/concept-planning/video-concept.json)\n\n# è©³ç´°å°æœ¬ã®ä½œæˆ\n\
        claude-code --prompt \"ä»¥ä¸‹ã®ã‚³ãƒ³ã‚»ãƒ—ãƒˆã«åŸºã¥ã„ã¦ã€è©³ç´°ãªå‹•ç”»å°æœ¬ã¨çµµã‚³ãƒ³ãƒ†ã‚’ä½œæˆã—ã¦ãã ã•ã„ï¼š\n\nå‹•ç”»ã‚³ãƒ³ã‚»ãƒ—ãƒˆ: $VIDEO_CONCEPT\n\
        \nä»¥ä¸‹ã®å½¢å¼ã§JSONã§å›žç­”ã—ã¦ãã ã•ã„ï¼š\n{\n  \\\"script_overview\\\": {\n    \\\"total_duration\\\
        \": \\\"ç·å°ºï¼ˆç§’ï¼‰\\\",\n    \\\"scene_count\\\": \\\"ã‚·ãƒ¼ãƒ³æ•°\\\",\n    \\\"narrative_structure\\\
        \": \\\"ç‰©èªžæ§‹é€ \\\"\n  },\n  \\\"detailed_script\\\": [\n    {\n      \\\"scene_number\\\
        \": 1,\n      \\\"duration_seconds\\\": \\\"ã‚·ãƒ¼ãƒ³å°º\\\",\n      \\\"scene_type\\\
        \": \\\"intro|main|transition|outro\\\",\n      \\\"visual_description\\\"\
        : \\\"æ˜ åƒã®è©³ç´°èª¬æ˜Ž\\\",\n      \\\"audio_description\\\": \\\"éŸ³å£°ãƒ»éŸ³æ¥½ã®èª¬æ˜Ž\\\",\n \
        \     \\\"text_overlay\\\": \\\"ãƒ†ã‚­ã‚¹ãƒˆã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤å†…å®¹\\\",\n      \\\"transition_type\\\
        \": \\\"åˆ‡ã‚Šæ›¿ãˆæ–¹æ³•\\\",\n      \\\"key_elements\\\": [\\\"é‡è¦ãªè¦–è¦šè¦ç´ \\\"],\n    \
        \  \\\"emotional_beat\\\": \\\"ã“ã®ã‚·ãƒ¼ãƒ³ã®æ„Ÿæƒ…çš„ãªå½¹å‰²\\\",\n      \\\"technical_notes\\\
        \": \\\"åˆ¶ä½œæ™‚ã®æŠ€è¡“çš„æ³¨æ„ç‚¹\\\"\n    }\n  ],\n  \\\"storyboard_frames\\\": [\n    {\n\
        \      \\\"frame_number\\\": 1,\n      \\\"scene_reference\\\": \\\"å¯¾å¿œã™ã‚‹ã‚·ãƒ¼ãƒ³ç•ªå·\\\
        \",\n      \\\"image_prompt\\\": \\\"ç”»åƒç”Ÿæˆç”¨ã®è©³ç´°ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ\\\",\n      \\\"composition\\\
        \": \\\"æ§‹å›³ã®èª¬æ˜Ž\\\",\n      \\\"lighting\\\": \\\"lighting setup\\\",\n    \
        \  \\\"camera_angle\\\": \\\"ã‚«ãƒ¡ãƒ©ã‚¢ãƒ³ã‚°ãƒ«\\\",\n      \\\"mood\\\": \\\"mood and\
        \ atmosphere\\\",\n      \\\"style_notes\\\": \\\"ã‚¹ã‚¿ã‚¤ãƒ«æŒ‡å®š\\\"\n    }\n  ],\n\
        \  \\\"audio_requirements\\\": {\n    \\\"background_music_style\\\": \\\"\
        BGMã®ã‚¹ã‚¿ã‚¤ãƒ«\\\",\n    \\\"sound_effects_needed\\\": [\\\"å¿…è¦ãªåŠ¹æžœéŸ³\\\"],\n    \\\
        \"voice_over_segments\\\": [\\\"ãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åŒºé–“\\\"],\n    \\\"audio_transitions\\\
        \": [\\\"éŸ³å£°ã®åˆ‡ã‚Šæ›¿ãˆ\\\"]\n  },\n  \\\"production_timeline\\\": {\n    \\\"pre_production_tasks\\\
        \": [\\\"äº‹å‰åˆ¶ä½œã‚¿ã‚¹ã‚¯\\\"],\n    \\\"production_sequence\\\": [\\\"åˆ¶ä½œé †åº\\\"],\n\
        \    \\\"post_production_tasks\\\": [\\\"å¾Œåˆ¶ä½œã‚¿ã‚¹ã‚¯\\\"]\n  }\n}\" > .logs/script-storyboard/detailed-script.json\n\
        \nDETAILED_SCRIPT=$(cat .logs/script-storyboard/detailed-script.json)\necho\
        \ \"DETAILED_SCRIPT_FILE=.logs/script-storyboard/detailed-script.json\" >>\
        \ $GITHUB_ENV\n\n# ã‚·ãƒ¼ãƒ³æ•°ã‚’ç’°å¢ƒå¤‰æ•°ã«è¨­å®š\nSCENE_COUNT=$(echo \"$DETAILED_SCRIPT\" |\
        \ jq -r '.script_overview.scene_count')\necho \"SCENE_COUNT=$SCENE_COUNT\"\
        \ >> $GITHUB_ENV\n\necho \"\U0001F4DD Script and storyboard creation completed\"\
        \necho \"Total scenes: $SCENE_COUNT\""
      shell: bash
  visual-consistency:
    needs: key_frame_generation
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - name: Check and adjust visual consistency
      run: "echo \"\U0001F50D Checking visual consistency...\"\n\nmkdir -p .logs/visual-creation/consistency\n\
        \nDETAILED_SCRIPT=$(cat .logs/script-storyboard/detailed-script.json)\nGENERATION_LOG=$(cat\
        \ .logs/visual-creation/keyframes/generation-log.json)\n\n# ç”Ÿæˆã•ã‚ŒãŸç”»åƒã®ä¸€è²«æ€§ã‚’AIåˆ†æž\n\
        claude-code --prompt \"ä»¥ä¸‹ã®å‹•ç”»åˆ¶ä½œæƒ…å ±ã‚’åŸºã«ã€ç”Ÿæˆã•ã‚ŒãŸç”»åƒã®è¦–è¦šçš„ä¸€è²«æ€§ã‚’åˆ†æžã—ã¦ãã ã•ã„ï¼š\n\nå‹•ç”»å°æœ¬: $DETAILED_SCRIPT\n\
        ç”»åƒç”Ÿæˆãƒ­ã‚°: $GENERATION_LOG\n\nä»¥ä¸‹ã®é …ç›®ã‚’è©•ä¾¡ã—ã€JSONã§å›žç­”ã—ã¦ãã ã•ã„ï¼š\n{\n  \\\"consistency_analysis\\\
        \": {\n    \\\"overall_style_consistency\\\": \\\"1-10ç‚¹ã§ã®è©•ä¾¡\\\",\n    \\\"\
        color_palette_coherence\\\": \\\"1-10ç‚¹ã§ã®è©•ä¾¡\\\",\n    \\\"lighting_consistency\\\
        \": \\\"1-10ç‚¹ã§ã®è©•ä¾¡\\\",\n    \\\"character_design_consistency\\\": \\\"1-10ç‚¹ã§ã®è©•ä¾¡\\\
        \",\n    \\\"environment_consistency\\\": \\\"1-10ç‚¹ã§ã®è©•ä¾¡\\\"\n  },\n  \\\"\
        identified_issues\\\": [\n    {\n      \\\"issue_type\\\": \\\"å•é¡Œã®ã‚¿ã‚¤ãƒ—\\\"\
        ,\n      \\\"affected_frames\\\": [\\\"å½±éŸ¿ã‚’å—ã‘ã‚‹ãƒ•ãƒ¬ãƒ¼ãƒ ç•ªå·\\\"],\n      \\\"description\\\
        \": \\\"å•é¡Œã®è©³ç´°\\\",\n      \\\"severity\\\": \\\"high|medium|low\\\",\n   \
        \   \\\"suggested_fix\\\": \\\"ä¿®æ­£ææ¡ˆ\\\"\n    }\n  ],\n  \\\"improvement_recommendations\\\
        \": [\n    {\n      \\\"frame_number\\\": \\\"ãƒ•ãƒ¬ãƒ¼ãƒ ç•ªå·\\\",\n      \\\"current_prompt\\\
        \": \\\"ç¾åœ¨ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ\\\",  \n      \\\"improved_prompt\\\": \\\"æ”¹å–„ã•ã‚ŒãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ\\\"\
        ,\n      \\\"reason\\\": \\\"æ”¹å–„ç†ç”±\\\"\n    }\n  ],\n  \\\"quality_score\\\"\
        : {\n    \\\"technical_quality\\\": \\\"1-10ç‚¹\\\",\n    \\\"artistic_coherence\\\
        \": \\\"1-10ç‚¹\\\",\n    \\\"brand_consistency\\\": \\\"1-10ç‚¹\\\",\n    \\\"\
        overall_readiness\\\": \\\"ready|needs_improvement|major_revision\\\"\n  },\n\
        \  \\\"next_steps\\\": [\\\"æŽ¨å¥¨ã•ã‚Œã‚‹æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—\\\"]\n}\" > .logs/visual-creation/consistency/analysis.json\n\
        \nCONSISTENCY_ANALYSIS=$(cat .logs/visual-creation/consistency/analysis.json)\n\
        OVERALL_READINESS=$(echo \"$CONSISTENCY_ANALYSIS\" | jq -r '.quality_score.overall_readiness')\n\
        \necho \"VISUAL_READINESS=$OVERALL_READINESS\" >> $GITHUB_ENV\necho \"CONSISTENCY_ANALYSIS_FILE=.logs/visual-creation/consistency/analysis.json\"\
        \ >> $GITHUB_ENV\n\necho \"\U0001F50D Visual consistency check completed:\
        \ $OVERALL_READINESS\""
      shell: bash
  workflow_summary:
    if: always()
    needs:
    - connectivity-test
    - concept-planning
    - script-storyboard
    - keyframe-generation
    - visual-consistency
    - primary-video-generation
    - audio-generation
    - quality-enhancement
    - final-packaging
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - name: Generate Workflow Summary
      run: "\necho \"\U0001F4CB video-content-creation Completion Summary\"\necho\
        \ \"================================\"\necho \"Total Tasks: 9\"\necho \"Description:\
        \ ãƒ†ã‚­ã‚¹ãƒˆâ†’ç”»åƒâ†’å‹•ç”»â†’éŸ³å£°ã®å®Œå…¨ãªå‹•ç”»ã‚³ãƒ³ãƒ†ãƒ³ãƒ„åˆ¶ä½œãƒ•ãƒ­ãƒ¼\"\necho \"Completed: $(date -u +%Y-%m-%dT%H:%M:%SZ)\"\
        \necho \"âœ… All tasks processed successfully\"\n\n# Create final output summary\n\
        mkdir -p outputs/final\ncat > outputs/final/workflow-summary.json << EOF\n\
        {\n  \"workflow_name\": \"video-content-creation\",\n  \"total_tasks\": 9,\n\
        \  \"completion_time\": \"$(date -u +%Y-%m-%dT%H:%M:%SZ)\",\n  \"status\"\
        : \"completed\"\n}\nEOF\n"
    - name: Upload Final Outputs
      uses: actions/upload-artifact@v4
      with:
        name: workflow-outputs-${{ github.run_number }}
        path: outputs/
        retention-days: 30
name: Generated video-content-creation
'on':
  workflow_dispatch:
    inputs:
      audio_integration:
        default: full_audio
        description: éŸ³å£°çµ±åˆ
        options:
        - full_audio
        - bgm_only
        - silent
        required: true
        type: choice
      color_mood:
        default: vibrant
        description: è‰²èª¿ãƒ»ãƒ ãƒ¼ãƒ‰
        options:
        - vibrant
        - warm
        - cool
        - monochrome
        - natural
        required: true
        type: choice
      frame_rate:
        default: 30fps
        description: ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¬ãƒ¼ãƒˆ
        options:
        - 24fps
        - 30fps
        - 60fps
        required: true
        type: choice
      target_audience:
        default: general
        description: ã‚¿ãƒ¼ã‚²ãƒƒãƒˆè¦–è´è€…
        options:
        - general
        - business
        - young_adult
        - professional
        - creative
        required: true
        type: choice
      video_concept:
        description: å‹•ç”»ã‚³ãƒ³ã‚»ãƒ—ãƒˆãƒ»ãƒ†ãƒ¼ãƒž
        required: true
        type: string
      video_length:
        default: '60'
        description: å‹•ç”»å°º (ç§’)
        required: true
        type: number
      video_quality:
        default: high_def
        description: å‹•ç”»å“è³ª
        options:
        - ultra_hd
        - high_def
        - standard
        required: true
        type: choice
      visual_style:
        default: commercial
        description: æ˜ åƒã‚¹ã‚¿ã‚¤ãƒ«
        options:
        - cinematic
        - documentary
        - commercial
        - educational
        - artistic
        required: true
        type: choice
permissions:
  actions: read
  contents: write
run-name: ${{ github.actor }} creates video-content-creation ðŸŽ¬ðŸŽµðŸŽ™ï¸
