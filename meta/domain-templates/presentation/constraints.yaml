# プレゼンテーション作成の制約条件と計算式

# 🚨 重要: スライド数計算は必須です
# プレゼンテーションの効果を最大化する重要要素
slide_calculation_constraints:
  # スライド数計算 - プレゼンテーションの骨格
  slide_calculation:
    importance: "CRITICAL - 情報量と時間配分の最適化に不可欠"
    formula: |
      base_slides = duration_minutes * 2  # 1分あたり2枚が基本
      complexity_adjustment = complexity_factor * 0.3
      total_slides = base_slides + complexity_adjustment
      
      where:
        - duration_minutes: プレゼンテーション時間（分）
        - complexity_factor: 1(低) / 2(中) / 3(高)
    
    slide_distribution:
      opening: "10% (導入・アジェンダ)"
      main_content: "70% (メインコンテンツ)"
      closing: "20% (まとめ・Q&A)"
    
    examples:
      - "5分・低複雑度 → 10 + 0 = 10枚"
      - "15分・中複雑度 → 30 + 2 = 32枚"
      - "30分・高複雑度 → 60 + 3 = 63枚"
  
  # 10-20-30ルール（Guy Kawasaki）
  ten_twenty_thirty_rule:
    slides: "10枚まで"
    minutes: "20分以内"
    font_size: "30pt以上"
    note: "ベンチャーピッチに最適"

cognitive_constraints:
  # 認知負荷理論
  cognitive_load:
    working_memory_limit:
      items: "7±2"
      duration: "20秒"
      implication: "1スライドに7つ以上の要素を置かない"
    
    dual_channel_processing:
      visual: "画像、図表、アイコン"
      verbal: "テキスト、音声"
      principle: "両チャンネルを適切に使い分ける"
    
    split_attention_effect:
      problem: "関連情報が離れていると理解が困難"
      solution: "関連要素は近接配置"
      max_distance: "視角5度以内"
  
  # 注意力管理
  attention_management:
    attention_span:
      initial: "100%"
      after_10min: "50%"
      after_20min: "20%"
      recovery_method: "インタラクティブ要素、ブレイク"
    
    primacy_recency_effect:
      strong_retention: ["最初の3分", "最後の2分"]
      weak_retention: "中間部分"
      strategy: "重要情報は最初と最後に配置"

design_constraints:
  # レイアウト原則
  layout_principles:
    rule_of_thirds:
      grid: "3x3"
      power_points: [
        "左上交点: 最重要情報",
        "右上交点: 補足情報",
        "中央: メインビジュアル"
      ]
    
    white_space:
      minimum: "30%"
      optimal: "40-50%"
      purpose: "視覚的休息、情報の階層化"
    
    visual_hierarchy:
      levels:
        1: "タイトル: 100%サイズ"
        2: "サブタイトル: 75%サイズ"
        3: "本文: 50%サイズ"
        4: "注釈: 35%サイズ"
  
  # カラースキーム
  color_psychology:
    primary_colors:
      blue: "信頼、安定（企業プレゼン）"
      red: "緊急、情熱（CTAに使用）"
      green: "成長、環境（サステナビリティ）"
      orange: "創造性、活力（スタートアップ）"
    
    contrast_ratios:
      text_background: "7:1（WCAG AAA）"
      important_elements: "4.5:1（WCAG AA）"
      decorative: "3:1（最小）"
    
    color_limit:
      primary: 1
      secondary: 2
      accent: 1
      total_max: 4

content_optimization:
  # スライド密度計算
  slide_density:
    formula: |
      density = (text_words + image_complexity * 50) / slide_area
      
      where:
        - text_words: 単語数
        - image_complexity: 1-5スケール
        - slide_area: ピクセル数 / 10000
      
      optimal_density: 15-25
      max_density: 40
    
    word_limits:
      title: "6単語以内"
      bullet_point: "7単語以内"
      total_per_slide: "30単語以内"
  
  # 読みやすさスコア
  readability:
    font_sizes:
      title: "44-54pt"
      subtitle: "32-40pt"
      body: "24-30pt"
      minimum: "18pt"
    
    line_spacing:
      minimum: "1.5x"
      optimal: "1.8-2.0x"
    
    contrast_check:
      tool: "WCAG Contrast Checker"
      minimum_ratio: 4.5
      enhanced_ratio: 7.0

animation_constraints:
  # トランジション設定
  transitions:
    duration:
      quick: "0.3s"
      standard: "0.5s"
      slow: "0.8s"
      max: "1.0s"
    
    types:
      fade: "最も自然、プロフェッショナル"
      slide: "方向性を示す"
      zoom: "フォーカスを示す"
      morph: "連続性を示す"
    
    frequency:
      rule: "同じトランジションを3回以上連続使用しない"
      variety: "3-4種類まで"
  
  # ビルドアニメーション
  build_animations:
    entrance_order:
      principle: "左→右、上→下の自然な流れ"
      timing: "0.2秒間隔"
    
    cognitive_pacing:
      items_per_build: "最大3つ"
      pause_between: "1-2秒"

data_visualization:
  # チャート選択ロジック
  chart_selection:
    comparison:
      few_items: "棒グラフ"
      many_items: "横棒グラフ"
      parts_of_whole: "円グラフ（5項目以下）"
    
    trend:
      continuous: "折れ線グラフ"
      discrete: "面グラフ"
      cyclical: "レーダーチャート"
    
    relationship:
      correlation: "散布図"
      distribution: "ヒストグラム"
      flow: "サンキー図"
  
  # データインク比
  data_ink_ratio:
    principle: "データ表現に使用するインクの割合を最大化"
    remove:
      - "不要なグリッド線"
      - "3D効果"
      - "影・グラデーション"
      - "冗長な凡例"
    
    target_ratio: "> 0.9"

presentation_flow:
  # ストーリー構造
  narrative_structure:
    three_act:
      act1: "設定（25%）: 問題提起"
      act2: "対立（50%）: 課題と解決策"
      act3: "解決（25%）: 結論とCTA"
    
    hero_journey:
      stages: [
        "日常世界",
        "冒険への召命",
        "試練",
        "報酬",
        "帰還"
      ]
  
  # ペーシング計算
  pacing:
    formula: |
      slides_per_minute = complexity_factor * audience_factor
      
      where:
        - complexity_factor:
          - simple: 2-3
          - medium: 1-2
          - complex: 0.5-1
        - audience_factor:
          - expert: 1.5
          - general: 1.0
          - novice: 0.7
    
    interaction_points:
      frequency: "5-7分ごと"
      types: ["Q&A", "投票", "デモ", "演習"]

platform_optimization:
  # 配信形式別最適化
  in_person:
    screen_size_assumption: "> 100インチ"
    font_size_multiplier: 1.0
    animation_complexity: "high"
    interaction_level: "high"
  
  online:
    screen_size_assumption: "13-27インチ"
    font_size_multiplier: 1.2
    animation_complexity: "medium"
    interaction_level: "medium"
    bandwidth_consideration: true
  
  hybrid:
    dual_optimization: true
    fallback_to: "online"
    redundancy_required: true

quality_metrics:
  # 自動評価指標
  automated_checks:
    consistency:
      - "フォント統一性"
      - "カラースキーム遵守"
      - "レイアウトグリッド整合"
      - "アニメーション一貫性"
    
    accessibility:
      - "カラーコントラスト"
      - "代替テキスト"
      - "読み上げ順序"
      - "キーボードナビゲーション"
    
    performance:
      - "ファイルサイズ"
      - "画像最適化"
      - "フォント埋め込み"
      - "メディア圧縮"
  
  # スコアリング
  quality_score:
    formula: |
      score = (
        design_score * 0.3 +
        content_score * 0.4 +
        flow_score * 0.2 +
        technical_score * 0.1
      )
    
    thresholds:
      excellent: "> 90"
      good: "75-90"
      acceptable: "60-75"
      needs_improvement: "< 60"

# Rule references (domain rule files to load additionally)
rule_references:
  - path: "meta/domain-templates/presentation/rules/task-breakdown.yaml"
    purpose: "Task decomposition into atomic steps"

# Checklist references (domain-specific MUST/SHOULD)
checklist_references:
  - path: "meta/domain-templates/presentation/checklists/general.md"
    purpose: "MUST/SHOULD checklist for presentation workflows"