# プレゼンテーション作成ワークフローの入力パラメータスキーマ

inputs:
  # 必須パラメータ
  required:
    presentation_title:
      type: string
      description: "プレゼンテーションのタイトル"
      example: "2025年度事業戦略 - デジタルトランスフォーメーション推進"
      validation: "max_length: 100"
    
    presentation_type:
      type: string
      description: "プレゼンテーションの種類"
      enum: ["pitch", "corporate", "conference", "training", "sales", "report", "workshop"]
      default: "corporate"
      impacts:
        - "デザインテンプレートの選択"
        - "スライド構成の決定"
        - "アニメーション複雑度"
    
    duration:
      type: integer
      description: "プレゼンテーション時間（分）"
      range: [3, 120]
      default: 20
      calculation: "推奨スライド数 = duration * 1.5"
    
    audience_type:
      type: string
      description: "対象聴衆"
      enum: ["executives", "investors", "technical", "general", "academic", "sales_prospects"]
      default: "general"
      impacts:
        - "専門用語の使用レベル"
        - "データの詳細度"
        - "ビジュアルの複雑さ"
  
  # 推奨パラメータ（プロ向け）
  recommended:
    design_theme:
      type: object
      description: "デザインテーマ設定"
      properties:
        style:
          type: string
          enum: ["minimalist", "corporate", "creative", "technical", "elegant", "playful"]
          default: "corporate"
        
        color_scheme:
          type: string
          enum: ["monochrome", "brand_colors", "vibrant", "pastel", "dark_mode", "high_contrast"]
          default: "brand_colors"
        
        typography:
          type: object
          properties:
            heading_font:
              type: string
              enum: ["sans-serif", "serif", "display", "monospace"]
              default: "sans-serif"
            
            body_font:
              type: string
              enum: ["sans-serif", "serif"]
              default: "sans-serif"
    
    content_structure:
      type: object
      description: "コンテンツ構成"
      properties:
        opening_style:
          type: string
          enum: ["question", "statistic", "story", "quote", "problem_statement"]
          default: "problem_statement"
        
        main_sections:
          type: integer
          range: [3, 7]
          default: 4
          description: "メインセクション数（マジックナンバー7±2）"
        
        closing_style:
          type: string
          enum: ["summary", "call_to_action", "question", "vision", "next_steps"]
          default: "call_to_action"
    
    data_visualization:
      type: object
      description: "データ可視化設定"
      properties:
        chart_style:
          type: string
          enum: ["flat", "3d", "infographic", "minimal", "detailed"]
          default: "flat"
        
        data_animation:
          type: boolean
          default: true
          description: "データの段階的表示"
        
        complexity_level:
          type: string
          enum: ["simple", "moderate", "detailed"]
          default: "moderate"
    
    interaction_elements:
      type: object
      description: "インタラクティブ要素"
      properties:
        q_and_a_slides:
          type: integer
          default: 2
          description: "Q&Aスライドの数"
        
        poll_questions:
          type: integer
          default: 0
          description: "投票質問の数"
        
        breakout_points:
          type: integer
          default: 0
          description: "ブレイクアウトセッションの数"
  
  # オプションパラメータ（上級者向け）
  optional:
    advanced_features:
      type: object
      description: "高度な機能設定"
      properties:
        slide_transitions:
          type: object
          properties:
            type:
              type: string
              enum: ["none", "fade", "slide", "zoom", "morph", "dynamic"]
              default: "fade"
            
            duration_ms:
              type: integer
              range: [300, 1000]
              default: 500
        
        speaker_notes:
          type: object
          properties:
            generate:
              type: boolean
              default: true
            
            detail_level:
              type: string
              enum: ["bullet_points", "script", "detailed_script"]
              default: "bullet_points"
            
            timing_cues:
              type: boolean
              default: true
        
        handout_version:
          type: boolean
          default: false
          description: "配布資料版の生成"
    
    accessibility_options:
      type: object
      description: "アクセシビリティ設定"
      properties:
        high_contrast_mode:
          type: boolean
          default: false
        
        screen_reader_optimization:
          type: boolean
          default: true
        
        subtitle_generation:
          type: boolean
          default: false
        
        sign_language_space:
          type: boolean
          default: false
          description: "手話通訳用スペース確保"
    
    export_options:
      type: object
      description: "エクスポート設定"
      properties:
        formats:
          type: array
          items:
            type: string
            enum: ["pptx", "pdf", "html", "video", "images"]
          default: ["pptx", "pdf"]
        
        resolution:
          type: string
          enum: ["standard", "high", "4k"]
          default: "high"
        
        include_animations:
          type: boolean
          default: true
        
        compress_media:
          type: boolean
          default: true
    
    branding_elements:
      type: object
      description: "ブランディング要素"
      properties:
        logo_placement:
          type: string
          enum: ["none", "title_only", "all_slides", "first_last"]
          default: "all_slides"
        
        logo_position:
          type: string
          enum: ["top_left", "top_right", "bottom_left", "bottom_right"]
          default: "bottom_right"
        
        footer_text:
          type: string
          example: "© 2025 Company Name - Confidential"
        
        watermark:
          type: object
          properties:
            enabled:
              type: boolean
              default: false
            
            text:
              type: string
              example: "DRAFT"
            
            opacity:
              type: number
              range: [0.1, 0.5]
              default: 0.2

# 自動計算されるパラメータ
computed_parameters:
  total_slides:
    formula: |
      base_slides = duration * 1.5
      adjusted_slides = base_slides * complexity_factor
      final_slides = clamp(adjusted_slides, 10, 100)
    
    complexity_factors:
      technical: 1.3
      executive: 0.8
      training: 1.5
  
  content_density:
    formula: |
      words_per_slide = audience_factor * complexity_factor
      images_per_slide = 1 / density_factor
    
    audience_factors:
      technical: 50
      executive: 30
      general: 40
  
  animation_complexity:
    formula: |
      if presentation_type == "pitch":
        complexity = "high"
      elif online_delivery:
        complexity = "medium"
      else:
        complexity = audience_preference
  
  file_size_estimate:
    formula: |
      base_size = slides * 0.5  # MB
      media_size = images * 2 + videos * 50
      total_size = base_size + media_size

# バリデーションルール
validation_rules:
  - name: "slide_time_ratio"
    rule: |
      if total_slides / duration > 3:
        warning: "スライド数が多すぎます。1分あたり2-3枚を推奨"
  
  - name: "cognitive_overload_check"
    rule: |
      if main_sections > 7:
        error: "セクション数が認知限界を超えています（最大7）"
  
  - name: "accessibility_compliance"
    rule: |
      if audience_type == "general" and !high_contrast_mode:
        suggestion: "一般聴衆にはハイコントラストモードを推奨"
  
  - name: "file_size_warning"
    rule: |
      if computed.file_size_estimate > 100:
        warning: "ファイルサイズが100MBを超える可能性があります"