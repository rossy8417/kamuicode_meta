# Rule references (domain rule files to load additionally)
rule_references:
  - path: "meta/domain-templates/animation/rules/task-breakdown.yaml"
    purpose: "Task decomposition into atomic steps"

# Checklist references (domain-specific MUST/SHOULD)
checklist_references:
  - path: "meta/domain-templates/animation/checklists/general.md"
    purpose: "MUST/SHOULD checklist for animation"
# アニメーション制作の制約条件と計算式

# 🚨 重要: シーン数計算は必須です
# アニメーションの流れと品質を決定する重要要素
timing_constraints:
  # シーン数計算 - アニメーションの構成要素
  scene_calculation:
    importance: "CRITICAL - スムーズなストーリーテリングに不可欠"
    formula: |
      total_scenes = ceil(duration_seconds / average_scene_length)
      where:
        - average_scene_length = 4.0 (3-5秒、カット割りが多いため短め)
        - buffer_scenes = ceil(total_scenes * 0.15) # 15%の予備シーン
        - final_scene_count = total_scenes + buffer_scenes
    
    scene_types:
      - establishing_shot: "場面設定（3-5秒）"
      - action_sequence: "アクションシーケンス（2-4秒）"
      - reaction_shot: "リアクションショット（1-2秒）"
      - transition: "トランジション（0.5-1秒）"
    
    examples:
      - "duration: 30s → scenes: 8 + 2 = 10"
      - "duration: 60s → scenes: 15 + 3 = 18"
      - "duration: 180s → scenes: 45 + 7 = 52"
  
  # フレームレート考慮
  framerate_constraints:
    traditional_anime: "24fps (2コマ打ち = 実質12fps)"
    full_animation: "24-30fps"
    high_quality: "60fps"
    
    impact_on_scenes: |
      - 低フレームレート: より長いシーン尺が必要
      - 高フレームレート: 短いカットでも視認可能

technical_constraints:
  # レンダリング制約
  rendering:
    max_concurrent_scenes: 3
    memory_per_scene: "2-4GB"
    time_per_scene: "30-120秒"
  
  # スタイル一貫性
  style_consistency:
    character_model: "全シーンで統一必須"
    color_palette: "事前定義必須"
    motion_style: "イージング・タイミング統一"

parallel_processing:
  # バッチ処理戦略
  scene_batching:
    strategy: "依存関係のないシーンを並列処理"
    max_parallel: 3
    grouping:
      - "背景ショット: 並列可能"
      - "キャラクターアニメーション: 順次処理推奨"
      - "エフェクト: 最後にオーバーレイ"

quality_assurance:
  # アニメーション品質基準
  motion_quality:
    smoothness: "フレーム間の連続性"
    timing: "12原則の遵守"
    appeal: "視覚的魅力"
  
  scene_review:
    - "各シーンの動きの流れ"
    - "シーン間のつながり"
    - "全体のリズムとペース"

failure_recovery:
  # シーン単位のリカバリー
  scene_failure:
    detection: "レンダリング失敗、品質不足"
    recovery: "該当シーンのみ再生成"
    fallback: "簡易版での代替"