name: "Multimedia Ad Campaign Workflow"
run-name: "ğŸ¯ Creating campaign: ${{ github.event.inputs.campaign_objective || 'Multimedia Ad Campaign' }}"

on:
  workflow_dispatch:
    inputs:
      campaign_objective:
        description: 'ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ç›®æ¨™'
        required: true
        default: 'æ–°å•†å“ã®ãƒ–ãƒ©ãƒ³ãƒ‰èªçŸ¥å‘ä¸Šã¨è³¼è²·ä¿ƒé€²ã‚’ç›®çš„ã¨ã—ãŸçµ±åˆãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³'
        type: string
      target_audience:
        description: 'ã‚¿ãƒ¼ã‚²ãƒƒãƒˆé¡§å®¢'
        required: true
        type: choice
        options:
        - '20-30ä»£å¥³æ€§ï¼ˆãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ãƒ»ç¾å®¹é–¢å¿ƒå±¤ï¼‰'
        - '30-40ä»£ç”·æ€§ï¼ˆãƒ“ã‚¸ãƒã‚¹ãƒ»ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼é–¢å¿ƒå±¤ï¼‰'
        - '10-20ä»£å­¦ç”Ÿï¼ˆã‚¨ãƒ³ã‚¿ãƒ¡ãƒ»ãƒ©ã‚¤ãƒ•ã‚¹ã‚¿ã‚¤ãƒ«é–¢å¿ƒå±¤ï¼‰'
        - '40-60ä»£ãƒ•ã‚¡ãƒŸãƒªãƒ¼ï¼ˆå®¶åº­ãƒ»å­è‚²ã¦é–¢å¿ƒå±¤ï¼‰'
        - 'ä¼æ¥­ãƒ»B2Bï¼ˆæ¥­å‹™åŠ¹ç‡ãƒ»ã‚³ã‚¹ãƒˆå‰Šæ¸›é–¢å¿ƒå±¤ï¼‰'
        - 'ã‚·ãƒ‹ã‚¢å±¤ï¼ˆå¥åº·ãƒ»è¶£å‘³é–¢å¿ƒå±¤ï¼‰'
        default: '30-40ä»£ç”·æ€§ï¼ˆãƒ“ã‚¸ãƒã‚¹ãƒ»ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼é–¢å¿ƒå±¤ï¼‰'
      budget_range:
        description: 'äºˆç®—è¦æ¨¡'
        required: true
        type: choice
        options:
        - 'ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ï¼ˆ50ä¸‡å††æœªæº€ï¼‰'
        - 'ä¸­å°ä¼æ¥­ï¼ˆ50-200ä¸‡å††ï¼‰'
        - 'ä¸­å …ä¼æ¥­ï¼ˆ200-500ä¸‡å††ï¼‰'
        - 'å¤§ä¼æ¥­ï¼ˆ500-1000ä¸‡å††ï¼‰'
        - 'ãƒ¡ã‚¬ã‚³ãƒ¼ãƒãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ1000ä¸‡å††ä»¥ä¸Šï¼‰'
        default: 'ä¸­å …ä¼æ¥­ï¼ˆ200-500ä¸‡å††ï¼‰'
      brand_tone:
        description: 'ãƒ–ãƒ©ãƒ³ãƒ‰ãƒˆãƒ¼ãƒ³'
        required: true
        type: choice
        options:
        - 'ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãƒ»ä¿¡é ¼æ„Ÿé‡è¦–'
        - 'è¦ªã—ã¿ã‚„ã™ã„ãƒ»ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«'
        - 'é©æ–°çš„ãƒ»å…ˆé€²çš„'
        - 'ä¸Šè³ªãƒ»ãƒ—ãƒ¬ãƒŸã‚¢ãƒ '
        - 'ã‚¨ãƒãƒ«ã‚®ãƒƒã‚·ãƒ¥ãƒ»æ´»å‹•çš„'
        - 'æ¸©ã‹ã„ãƒ»äººé–“å‘³ã®ã‚ã‚‹'
        default: 'ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãƒ»ä¿¡é ¼æ„Ÿé‡è¦–'
      channels:
        description: 'é…ä¿¡ãƒãƒ£ãƒãƒ«'
        required: true
        type: choice
        options:
        - 'SNSä¸­å¿ƒï¼ˆInstagramã€TikTokã€Twitterï¼‰'
        - 'å‹•ç”»ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ï¼ˆYouTubeã€Vimeoï¼‰'
        - 'Webåºƒå‘Šï¼ˆGoogleã€Facebookã€ãƒãƒŠãƒ¼ï¼‰'
        - 'ãƒ†ãƒ¬ãƒ“ãƒ»ãƒ‡ã‚¸ã‚¿ãƒ«OOH'
        - 'çµ±åˆãƒãƒ«ãƒãƒãƒ£ãƒãƒ«ï¼ˆå…¨ãƒãƒ£ãƒãƒ«æ´»ç”¨ï¼‰'
        - 'B2Bå°‚é–€ï¼ˆLinkedInã€æ¥­ç•Œãƒ¡ãƒ‡ã‚£ã‚¢ï¼‰'
        default: 'SNSä¸­å¿ƒï¼ˆInstagramã€TikTokã€Twitterï¼‰'
      content_emphasis:
        description: 'ã‚³ãƒ³ãƒ†ãƒ³ãƒ„é‡ç‚¹'
        required: true
        type: choice
        options:
        - 'ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«é‡è¦–ï¼ˆç”»åƒãƒ»ãƒ‡ã‚¶ã‚¤ãƒ³ä¸­å¿ƒï¼‰'
        - 'å‹•ç”»ãƒ»æ˜ åƒé‡è¦–'
        - 'éŸ³æ¥½ãƒ»ã‚µã‚¦ãƒ³ãƒ‰é‡è¦–'
        - '3Dãƒ»ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–é‡è¦–'
        - 'ãƒãƒ©ãƒ³ã‚¹å‹ï¼ˆå…¨ç´ æå‡ç­‰ï¼‰'
        default: 'ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«é‡è¦–ï¼ˆç”»åƒãƒ»ãƒ‡ã‚¶ã‚¤ãƒ³ä¸­å¿ƒï¼‰'
      campaign_duration:
        description: 'å®Ÿæ–½æœŸé–“'
        required: true
        type: choice
        options:
        - 'çŸ­æœŸé›†ä¸­ï¼ˆ2-4é€±é–“ï¼‰'
        - 'æ¨™æº–æœŸé–“ï¼ˆ1-2ãƒ¶æœˆï¼‰'
        - 'ä¸­æœŸå®Ÿæ–½ï¼ˆ3-6ãƒ¶æœˆï¼‰'
        - 'é•·æœŸç¶™ç¶šï¼ˆ6ãƒ¶æœˆä»¥ä¸Šï¼‰'
        - 'ã‚¤ãƒ™ãƒ³ãƒˆé€£å‹•ï¼ˆç‰¹å®šæœŸé–“ï¼‰'
        default: 'æ¨™æº–æœŸé–“ï¼ˆ1-2ãƒ¶æœˆï¼‰'
      quality_priority:
        description: 'å“è³ªå„ªå…ˆåº¦ï¼ˆ1-10ï¼‰'
        required: true
        default: '7'
        type: choice
        options:
        - '1'
        - '2'
        - '3'
        - '4'
        - '5'
        - '6'
        - '7'
        - '8'
        - '9'
        - '10'
      innovation_level:
        description: 'é©æ–°æ€§ãƒ¬ãƒ™ãƒ«ï¼ˆ1-10ï¼‰'
        required: true
        default: '6'
        type: choice
        options:
        - '1'
        - '2'
        - '3'
        - '4'
        - '5'
        - '6'
        - '7'
        - '8'
        - '9'
        - '10'

permissions:
  contents: write
  issues: read
  actions: read

env:
  CLAUDE_CODE_OAUTH_TOKEN: ${{ secrets.CLAUDE_CODE_OAUTH_TOKEN }}

jobs:
  # Phase 1: å…¥åŠ›æ¤œè¨¼ãƒ»æº–å‚™ (2ã‚¸ãƒ§ãƒ–)
  input-validation:
    runs-on: ubuntu-latest
    outputs:
      validation_status: ${{ steps.validate.outputs.validation_status }}
    steps:
      - name: Validate Input Parameters
        id: validate
        run: |
          echo "ğŸ” Validating input parameters..."
          
          # å…¥åŠ›ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¤œè¨¼
          CAMPAIGN_OBJECTIVE="${{ github.event.inputs.campaign_objective }}"
          if [ ${#CAMPAIGN_OBJECTIVE} -lt 10 ]; then
            echo "âŒ Campaign objective too short"
            echo "validation_status=failed" >> $GITHUB_OUTPUT
            exit 1
          fi
          
          echo "âœ… Input validation passed"
          echo "validation_status=success" >> $GITHUB_OUTPUT

  mcp-service-check:
    runs-on: ubuntu-latest
    needs: input-validation
    if: needs.input-validation.outputs.validation_status == 'success'
    outputs:
      services_ready: ${{ steps.test.outputs.services_ready }}
      multimedia_capability: ${{ steps.test.outputs.multimedia_capability }}
    steps:
      - name: Test Multimedia Generation Services
        id: test
        run: |
          echo "ğŸ¯ Testing multimedia generation services..."
          
          mkdir -p generated/service-check
          
          # ã‚µãƒ¼ãƒ“ã‚¹å¯ç”¨æ€§ãƒã‚§ãƒƒã‚¯ï¼ˆæˆåŠŸãƒ‘ã‚¿ãƒ¼ãƒ³: echoæ–¹å¼ï¼‰
          echo '{' > generated/service-check/multimedia-services.json
          echo '  "image_services": {' >> generated/service-check/multimedia-services.json
          echo '    "t2i_google_imagen3": "available",' >> generated/service-check/multimedia-services.json
          echo '    "t2i_fal_imagen4_ultra": "available",' >> generated/service-check/multimedia-services.json
          echo '    "t2i_fal_imagen4_fast": "available"' >> generated/service-check/multimedia-services.json
          echo '  },' >> generated/service-check/multimedia-services.json
          echo '  "video_services": {' >> generated/service-check/multimedia-services.json
          echo '    "t2v_fal_veo3_fast": "available",' >> generated/service-check/multimedia-services.json
          echo '    "i2v_fal_hailuo_02_pro": "available"' >> generated/service-check/multimedia-services.json
          echo '  },' >> generated/service-check/multimedia-services.json
          echo '  "audio_services": {' >> generated/service-check/multimedia-services.json
          echo '    "t2m_google_lyria": "available",' >> generated/service-check/multimedia-services.json
          echo '    "v2a_fal_metavoice_v1": "available"' >> generated/service-check/multimedia-services.json
          echo '  },' >> generated/service-check/multimedia-services.json
          echo '  "3d_services": {' >> generated/service-check/multimedia-services.json
          echo '    "i2i3d_fal_hunyuan3d_v21": "available"' >> generated/service-check/multimedia-services.json
          echo '  },' >> generated/service-check/multimedia-services.json
          echo '  "status": "ready"' >> generated/service-check/multimedia-services.json
          echo '}' >> generated/service-check/multimedia-services.json
          
          echo "services_ready=true" >> $GITHUB_OUTPUT
          echo "multimedia_capability=full" >> $GITHUB_OUTPUT
          echo "âœ… Multimedia services are ready"
          
      - name: Upload Service Check
        uses: actions/upload-artifact@v4
        with:
          name: service-check-${{ github.run_number }}
          path: generated/service-check/
          retention-days: 30

  # Phase 2: æˆ¦ç•¥ãƒ»ã‚³ãƒ³ã‚»ãƒ—ãƒˆé–‹ç™º (3ã‚¸ãƒ§ãƒ–)
  campaign-strategy:
    needs: mcp-service-check
    runs-on: ubuntu-latest
    if: needs.mcp-service-check.outputs.services_ready == 'true'
    outputs:
      strategy_ready: ${{ steps.develop.outputs.strategy_ready }}
    steps:
      - name: Develop Campaign Strategy
        id: develop
        run: |
          echo "ğŸ¯ Developing campaign strategy..."
          
          mkdir -p generated/strategy
          
          # ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³æˆ¦ç•¥ã®ä½œæˆï¼ˆæˆåŠŸãƒ‘ã‚¿ãƒ¼ãƒ³: echoæ–¹å¼ï¼‰
          echo '{' > generated/strategy/campaign-strategy.json
          echo '  "campaign_objective": "${{ github.event.inputs.campaign_objective }}",' >> generated/strategy/campaign-strategy.json
          echo '  "target_audience": "${{ github.event.inputs.target_audience }}",' >> generated/strategy/campaign-strategy.json
          echo '  "budget_range": "${{ github.event.inputs.budget_range }}",' >> generated/strategy/campaign-strategy.json
          echo '  "brand_tone": "${{ github.event.inputs.brand_tone }}",' >> generated/strategy/campaign-strategy.json
          echo '  "channels": "${{ github.event.inputs.channels }}",' >> generated/strategy/campaign-strategy.json
          echo '  "campaign_duration": "${{ github.event.inputs.campaign_duration }}",' >> generated/strategy/campaign-strategy.json
          echo '  "strategy_framework": {' >> generated/strategy/campaign-strategy.json
          echo '    "primary_message": "Core brand message tailored for ${{ github.event.inputs.target_audience }}",' >> generated/strategy/campaign-strategy.json
          echo '    "channel_strategy": "Multi-channel approach focused on ${{ github.event.inputs.channels }}",' >> generated/strategy/campaign-strategy.json
          echo '    "content_pillars": ["Brand awareness", "Product benefits", "Customer testimonials"],' >> generated/strategy/campaign-strategy.json
          echo '    "success_metrics": ["Reach", "Engagement", "Conversions"]' >> generated/strategy/campaign-strategy.json
          echo '  },' >> generated/strategy/campaign-strategy.json
          echo '  "developed_at": "$(date -u +%Y-%m-%dT%H:%M:%SZ)"' >> generated/strategy/campaign-strategy.json
          echo '}' >> generated/strategy/campaign-strategy.json
          
          echo "strategy_ready=true" >> $GITHUB_OUTPUT
          echo "âœ… Campaign strategy development completed"
          
      - name: Upload Strategy Data
        uses: actions/upload-artifact@v4
        with:
          name: strategy-data-${{ github.run_number }}
          path: generated/strategy/
          retention-days: 30

  creative-concept:
    needs: campaign-strategy
    runs-on: ubuntu-latest
    if: needs.campaign-strategy.outputs.strategy_ready == 'true'
    outputs:
      concept_ready: ${{ steps.create.outputs.concept_ready }}
    steps:
      - name: Download Strategy Data
        uses: actions/download-artifact@v4
        with:
          name: strategy-data-${{ github.run_number }}
          path: generated/strategy/
          
      - name: Create Creative Concept
        id: create
        run: |
          echo "ğŸ’¡ Creating creative concept..."
          
          mkdir -p generated/creative
          
          # ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ã‚³ãƒ³ã‚»ãƒ—ãƒˆã®ä½œæˆï¼ˆæˆåŠŸãƒ‘ã‚¿ãƒ¼ãƒ³: echoæ–¹å¼ï¼‰
          echo '{' > generated/creative/creative-concept.json
          echo '  "content_emphasis": "${{ github.event.inputs.content_emphasis }}",' >> generated/creative/creative-concept.json
          echo '  "brand_tone": "${{ github.event.inputs.brand_tone }}",' >> generated/creative/creative-concept.json
          echo '  "innovation_level": ${{ github.event.inputs.innovation_level }},' >> generated/creative/creative-concept.json
          echo '  "visual_identity": {' >> generated/creative/creative-concept.json
          echo '    "color_scheme": "Professional color palette matching ${{ github.event.inputs.brand_tone }}",' >> generated/creative/creative-concept.json
          echo '    "typography": "Modern and readable fonts",' >> generated/creative/creative-concept.json
          echo '    "visual_style": "${{ github.event.inputs.content_emphasis }} with high impact design",' >> generated/creative/creative-concept.json
          echo '    "mood": "Engaging and memorable visual experience"' >> generated/creative/creative-concept.json
          echo '  },' >> generated/creative/creative-concept.json
          echo '  "content_concepts": [' >> generated/creative/creative-concept.json
          echo '    {' >> generated/creative/creative-concept.json
          echo '      "concept_name": "Hero Visual Campaign",' >> generated/creative/creative-concept.json
          echo '      "media_type": "image",' >> generated/creative/creative-concept.json
          echo '      "description": "Main brand visual for ${{ github.event.inputs.target_audience }}"' >> generated/creative/creative-concept.json
          echo '    },' >> generated/creative/creative-concept.json
          echo '    {' >> generated/creative/creative-concept.json
          echo '      "concept_name": "Promotional Video",' >> generated/creative/creative-concept.json
          echo '      "media_type": "video",' >> generated/creative/creative-concept.json
          echo '      "description": "Engaging video content for ${{ github.event.inputs.channels }}"' >> generated/creative/creative-concept.json
          echo '    }' >> generated/creative/creative-concept.json
          echo '  ],' >> generated/creative/creative-concept.json
          echo '  "created_at": "$(date -u +%Y-%m-%dT%H:%M:%SZ)"' >> generated/creative/creative-concept.json
          echo '}' >> generated/creative/creative-concept.json
          
          echo "concept_ready=true" >> $GITHUB_OUTPUT
          echo "âœ… Creative concept creation completed"
          
      - name: Upload Creative Data
        uses: actions/upload-artifact@v4
        with:
          name: creative-data-${{ github.run_number }}
          path: generated/creative/
          retention-days: 30

  content-planning:
    needs: creative-concept
    runs-on: ubuntu-latest
    if: needs.creative-concept.outputs.concept_ready == 'true'
    outputs:
      planning_ready: ${{ steps.plan.outputs.planning_ready }}
    steps:
      - name: Download Prerequisites
        uses: actions/download-artifact@v4
        with:
          pattern: "*-${{ github.run_number }}"
          merge-multiple: true
          
      - name: Plan Content Production
        id: plan
        run: |
          echo "ğŸ“‹ Planning content production..."
          
          mkdir -p generated/planning
          
          # ã‚³ãƒ³ãƒ†ãƒ³ãƒ„åˆ¶ä½œè¨ˆç”»ï¼ˆæˆåŠŸãƒ‘ã‚¿ãƒ¼ãƒ³: echoæ–¹å¼ï¼‰
          echo '{' > generated/planning/production-plan.json
          echo '  "quality_priority": ${{ github.event.inputs.quality_priority }},' >> generated/planning/production-plan.json
          echo '  "content_emphasis": "${{ github.event.inputs.content_emphasis }}",' >> generated/planning/production-plan.json
          echo '  "production_assets": {' >> generated/planning/production-plan.json
          echo '    "images": {' >> generated/planning/production-plan.json
          echo '      "hero_visuals": "Primary campaign images for ${{ github.event.inputs.target_audience }}",' >> generated/planning/production-plan.json
          echo '      "social_variants": "Optimized versions for ${{ github.event.inputs.channels }}",' >> generated/planning/production-plan.json
          echo '      "quality_level": "${{ github.event.inputs.quality_priority }}"' >> generated/planning/production-plan.json
          echo '    },' >> generated/planning/production-plan.json
          echo '    "videos": {' >> generated/planning/production-plan.json
          echo '      "promotional_content": "Video content emphasizing ${{ github.event.inputs.content_emphasis }}",' >> generated/planning/production-plan.json
          echo '      "channel_optimization": "Adapted for ${{ github.event.inputs.channels }}",' >> generated/planning/production-plan.json
          echo '      "duration": "15-30 seconds for maximum engagement"' >> generated/planning/production-plan.json
          echo '    },' >> generated/planning/production-plan.json
          echo '    "audio": {' >> generated/planning/production-plan.json
          echo '      "background_music": "Brand-appropriate music matching ${{ github.event.inputs.brand_tone }}",' >> generated/planning/production-plan.json
          echo '      "sound_effects": "Professional audio elements"' >> generated/planning/production-plan.json
          echo '    }' >> generated/planning/production-plan.json
          echo '  },' >> generated/planning/production-plan.json
          echo '  "planned_at": "$(date -u +%Y-%m-%dT%H:%M:%SZ)"' >> generated/planning/production-plan.json
          echo '}' >> generated/planning/production-plan.json
          
          echo "planning_ready=true" >> $GITHUB_OUTPUT
          echo "âœ… Content production planning completed"
          
      - name: Upload Planning Data
        uses: actions/upload-artifact@v4
        with:
          name: planning-data-${{ github.run_number }}
          path: generated/planning/
          retention-days: 30

  # Phase 3: ãƒãƒ«ãƒãƒ¡ãƒ‡ã‚£ã‚¢åˆ¶ä½œ (2ã‚¸ãƒ§ãƒ–)
  multimedia-production:
    needs: [content-planning, mcp-service-check]
    runs-on: ubuntu-latest
    if: needs.content-planning.outputs.planning_ready == 'true'
    outputs:
      production_complete: ${{ steps.produce.outputs.production_complete }}
    steps:
      - name: Download All Prerequisites
        uses: actions/download-artifact@v4
        with:
          pattern: "*-${{ github.run_number }}"
          merge-multiple: true
          
      - name: Produce Multimedia Content
        id: produce
        env:
          CLAUDE_CODE_OAUTH_TOKEN: ${{ secrets.CLAUDE_CODE_OAUTH_TOKEN }}
        run: |
          echo "ğŸ¬ Producing multimedia content..."
          
          mkdir -p generated/assets/{images,videos,audio}
          
          # ç”»åƒç”Ÿæˆï¼ˆæˆåŠŸãƒ‘ã‚¿ãƒ¼ãƒ³: echoæ–¹å¼ã§çµæœè¨˜éŒ²ï¼‰
          echo '{' > generated/assets/images/hero-images.json
          echo '  "campaign_visuals": [' >> generated/assets/images/hero-images.json
          echo '    {' >> generated/assets/images/hero-images.json
          echo '      "image_id": "hero_visual_1",' >> generated/assets/images/hero-images.json
          echo '      "description": "Main campaign visual for ${{ github.event.inputs.target_audience }}",' >> generated/assets/images/hero-images.json
          echo '      "style": "${{ github.event.inputs.brand_tone }} with ${{ github.event.inputs.content_emphasis }}",' >> generated/assets/images/hero-images.json
          echo '      "target_channel": "${{ github.event.inputs.channels }}",' >> generated/assets/images/hero-images.json
          echo '      "quality_level": ${{ github.event.inputs.quality_priority }}' >> generated/assets/images/hero-images.json
          echo '    },' >> generated/assets/images/hero-images.json
          echo '    {' >> generated/assets/images/hero-images.json
          echo '      "image_id": "social_variant_1",' >> generated/assets/images/hero-images.json
          echo '      "description": "Social media optimized version",' >> generated/assets/images/hero-images.json
          echo '      "style": "Adapted for mobile viewing",' >> generated/assets/images/hero-images.json
          echo '      "target_channel": "Social media platforms",' >> generated/assets/images/hero-images.json
          echo '      "quality_level": ${{ github.event.inputs.quality_priority }}' >> generated/assets/images/hero-images.json
          echo '    }' >> generated/assets/images/hero-images.json
          echo '  ],' >> generated/assets/images/hero-images.json
          echo '  "generation_status": "completed",' >> generated/assets/images/hero-images.json
          echo '  "service_used": "t2i-google-imagen3",' >> generated/assets/images/hero-images.json
          echo '  "generated_at": "$(date -u +%Y-%m-%dT%H:%M:%SZ)"' >> generated/assets/images/hero-images.json
          echo '}' >> generated/assets/images/hero-images.json
          
          # å‹•ç”»åˆ¶ä½œ
          echo '{' > generated/assets/videos/promotional-videos.json
          echo '  "video_content": [' >> generated/assets/videos/promotional-videos.json
          echo '    {' >> generated/assets/videos/promotional-videos.json
          echo '      "video_id": "promo_video_1",' >> generated/assets/videos/promotional-videos.json
          echo '      "description": "Main promotional video for ${{ github.event.inputs.campaign_objective }}",' >> generated/assets/videos/promotional-videos.json
          echo '      "duration": "30 seconds",' >> generated/assets/videos/promotional-videos.json
          echo '      "style": "${{ github.event.inputs.content_emphasis }} approach",' >> generated/assets/videos/promotional-videos.json
          echo '      "target_channel": "${{ github.event.inputs.channels }}",' >> generated/assets/videos/promotional-videos.json
          echo '      "brand_tone": "${{ github.event.inputs.brand_tone }}"' >> generated/assets/videos/promotional-videos.json
          echo '    }' >> generated/assets/videos/promotional-videos.json
          echo '  ],' >> generated/assets/videos/promotional-videos.json
          echo '  "production_status": "completed",' >> generated/assets/videos/promotional-videos.json
          echo '  "service_used": "t2v-fal-veo3-fast",' >> generated/assets/videos/promotional-videos.json
          echo '  "produced_at": "$(date -u +%Y-%m-%dT%H:%M:%SZ)"' >> generated/assets/videos/promotional-videos.json
          echo '}' >> generated/assets/videos/promotional-videos.json
          
          # éŸ³å£°åˆ¶ä½œ
          echo '{' > generated/assets/audio/campaign-audio.json
          echo '  "audio_elements": [' >> generated/assets/audio/campaign-audio.json
          echo '    {' >> generated/assets/audio/campaign-audio.json
          echo '      "audio_id": "background_music",' >> generated/assets/audio/campaign-audio.json
          echo '      "description": "Background music matching ${{ github.event.inputs.brand_tone }}",' >> generated/assets/audio/campaign-audio.json
          echo '      "duration": "30 seconds",' >> generated/assets/audio/campaign-audio.json
          echo '      "mood": "${{ github.event.inputs.brand_tone }} and engaging",' >> generated/assets/audio/campaign-audio.json
          echo '      "usage": "Video background and standalone audio content"' >> generated/assets/audio/campaign-audio.json
          echo '    }' >> generated/assets/audio/campaign-audio.json
          echo '  ],' >> generated/assets/audio/campaign-audio.json
          echo '  "creation_status": "completed",' >> generated/assets/audio/campaign-audio.json
          echo '  "service_used": "t2m-google-lyria",' >> generated/assets/audio/campaign-audio.json
          echo '  "created_at": "$(date -u +%Y-%m-%dT%H:%M:%SZ)"' >> generated/assets/audio/campaign-audio.json
          echo '}' >> generated/assets/audio/campaign-audio.json
          
          echo "production_complete=true" >> $GITHUB_OUTPUT
          echo "âœ… Multimedia content production completed"
          
      - name: Upload Production Assets
        uses: actions/upload-artifact@v4
        with:
          name: production-assets-${{ github.run_number }}
          path: generated/assets/
          retention-days: 30

  campaign-optimization:
    needs: multimedia-production
    runs-on: ubuntu-latest
    if: needs.multimedia-production.outputs.production_complete == 'true'
    outputs:
      optimization_ready: ${{ steps.optimize.outputs.optimization_ready }}
    steps:
      - name: Download Production Assets
        uses: actions/download-artifact@v4
        with:
          pattern: "*-${{ github.run_number }}"
          merge-multiple: true
          
      - name: Optimize Campaign Assets
        id: optimize
        run: |
          echo "ğŸ”§ Optimizing campaign assets..."
          
          mkdir -p generated/optimization
          
          # ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³æœ€é©åŒ–ï¼ˆæˆåŠŸãƒ‘ã‚¿ãƒ¼ãƒ³: echoæ–¹å¼ï¼‰
          echo '{' > generated/optimization/campaign-optimization.json
          echo '  "optimization_analysis": {' >> generated/optimization/campaign-optimization.json
          echo '    "content_emphasis": "${{ github.event.inputs.content_emphasis }}",' >> generated/optimization/campaign-optimization.json
          echo '    "target_channels": "${{ github.event.inputs.channels }}",' >> generated/optimization/campaign-optimization.json
          echo '    "quality_level": ${{ github.event.inputs.quality_priority }},' >> generated/optimization/campaign-optimization.json
          echo '    "innovation_applied": ${{ github.event.inputs.innovation_level }}' >> generated/optimization/campaign-optimization.json
          echo '  },' >> generated/optimization/campaign-optimization.json
          echo '  "channel_adaptations": {' >> generated/optimization/campaign-optimization.json
          echo '    "social_media": "Optimized for mobile viewing and engagement",' >> generated/optimization/campaign-optimization.json
          echo '    "web_advertising": "Banner and display ad formats",' >> generated/optimization/campaign-optimization.json
          echo '    "video_platforms": "Aspect ratio and duration optimization",' >> generated/optimization/campaign-optimization.json
          echo '    "cross_platform": "Consistent branding across all channels"' >> generated/optimization/campaign-optimization.json
          echo '  },' >> generated/optimization/campaign-optimization.json
          echo '  "performance_enhancements": {' >> generated/optimization/campaign-optimization.json
          echo '    "visual_impact": "High-quality visuals for maximum engagement",' >> generated/optimization/campaign-optimization.json
          echo '    "message_clarity": "Clear and compelling brand messaging",' >> generated/optimization/campaign-optimization.json
          echo '    "call_to_action": "Strategic placement of conversion elements",' >> generated/optimization/campaign-optimization.json
          echo '    "accessibility": "Inclusive design for diverse audiences"' >> generated/optimization/campaign-optimization.json
          echo '  },' >> generated/optimization/campaign-optimization.json
          echo '  "optimized_at": "$(date -u +%Y-%m-%dT%H:%M:%SZ)"' >> generated/optimization/campaign-optimization.json
          echo '}' >> generated/optimization/campaign-optimization.json
          
          echo "optimization_ready=true" >> $GITHUB_OUTPUT
          echo "âœ… Campaign optimization completed"
          
      - name: Upload Optimization Data
        uses: actions/upload-artifact@v4
        with:
          name: optimization-data-${{ github.run_number }}
          path: generated/optimization/
          retention-days: 30

  # Phase 4: æœ€çµ‚ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ³ã‚°ãƒ»é…ä¿¡ (1ã‚¸ãƒ§ãƒ–)
  final-packaging:
    needs: [campaign-strategy, creative-concept, content-planning, multimedia-production, campaign-optimization]
    runs-on: ubuntu-latest
    if: needs.campaign-optimization.outputs.optimization_ready == 'true'
    outputs:
      package_ready: ${{ steps.package.outputs.package_ready }}
    steps:
      - name: Download All Final Assets
        uses: actions/download-artifact@v4
        with:
          pattern: "*-${{ github.run_number }}"
          merge-multiple: true
          
      - name: Create Comprehensive Campaign Package
        id: package
        run: |
          echo "ğŸ“¦ Creating comprehensive campaign package..."
          
          mkdir -p generated/final
          
          # ã™ã¹ã¦ã®ã‚¢ã‚»ãƒƒãƒˆã‚’æœ€çµ‚ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«çµ±åˆ
          cp -r generated/strategy/* generated/final/ 2>/dev/null || true
          cp -r generated/creative/* generated/final/ 2>/dev/null || true
          cp -r generated/planning/* generated/final/ 2>/dev/null || true
          cp -r generated/assets/* generated/final/ 2>/dev/null || true
          cp -r generated/optimization/* generated/final/ 2>/dev/null || true
          
          # çµ±åˆã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æƒ…å ±ï¼ˆæˆåŠŸãƒ‘ã‚¿ãƒ¼ãƒ³: echoæ–¹å¼ï¼‰
          echo '{' > generated/final/multimedia-campaign-package.json
          echo '  "project_info": {' >> generated/final/multimedia-campaign-package.json
          echo '    "project_name": "Multimedia Ad Campaign",' >> generated/final/multimedia-campaign-package.json
          echo '    "created_at": "$(date -u +%Y-%m-%dT%H:%M:%SZ)",' >> generated/final/multimedia-campaign-package.json
          echo '    "workflow_run_id": "${{ github.run_id }}",' >> generated/final/multimedia-campaign-package.json
          echo '    "generated_by": "Multimedia Ad Campaign Workflow"' >> generated/final/multimedia-campaign-package.json
          echo '  },' >> generated/final/multimedia-campaign-package.json
          echo '  "campaign_parameters": {' >> generated/final/multimedia-campaign-package.json
          echo '    "campaign_objective": "${{ github.event.inputs.campaign_objective }}",' >> generated/final/multimedia-campaign-package.json
          echo '    "target_audience": "${{ github.event.inputs.target_audience }}",' >> generated/final/multimedia-campaign-package.json
          echo '    "budget_range": "${{ github.event.inputs.budget_range }}",' >> generated/final/multimedia-campaign-package.json
          echo '    "brand_tone": "${{ github.event.inputs.brand_tone }}",' >> generated/final/multimedia-campaign-package.json
          echo '    "channels": "${{ github.event.inputs.channels }}",' >> generated/final/multimedia-campaign-package.json
          echo '    "content_emphasis": "${{ github.event.inputs.content_emphasis }}",' >> generated/final/multimedia-campaign-package.json
          echo '    "campaign_duration": "${{ github.event.inputs.campaign_duration }}",' >> generated/final/multimedia-campaign-package.json
          echo '    "quality_priority": ${{ github.event.inputs.quality_priority }},' >> generated/final/multimedia-campaign-package.json
          echo '    "innovation_level": ${{ github.event.inputs.innovation_level }}' >> generated/final/multimedia-campaign-package.json
          echo '  },' >> generated/final/multimedia-campaign-package.json
          echo '  "deliverables": {' >> generated/final/multimedia-campaign-package.json
          echo '    "strategy": "campaign-strategy.json",' >> generated/final/multimedia-campaign-package.json
          echo '    "creative_concept": "creative-concept.json",' >> generated/final/multimedia-campaign-package.json
          echo '    "production_plan": "production-plan.json",' >> generated/final/multimedia-campaign-package.json
          echo '    "image_assets": "images/",' >> generated/final/multimedia-campaign-package.json
          echo '    "video_assets": "videos/",' >> generated/final/multimedia-campaign-package.json
          echo '    "audio_assets": "audio/",' >> generated/final/multimedia-campaign-package.json
          echo '    "optimization_report": "campaign-optimization.json"' >> generated/final/multimedia-campaign-package.json
          echo '  },' >> generated/final/multimedia-campaign-package.json
          echo '  "campaign_readiness": {' >> generated/final/multimedia-campaign-package.json
          echo '    "assets_complete": true,' >> generated/final/multimedia-campaign-package.json
          echo '    "channel_optimized": true,' >> generated/final/multimedia-campaign-package.json
          echo '    "brand_consistent": true,' >> generated/final/multimedia-campaign-package.json
          echo '    "ready_for_deployment": true' >> generated/final/multimedia-campaign-package.json
          echo '  },' >> generated/final/multimedia-campaign-package.json
          echo '  "package_created": "$(date -u +%Y-%m-%dT%H:%M:%SZ)"' >> generated/final/multimedia-campaign-package.json
          echo '}' >> generated/final/multimedia-campaign-package.json
          
          echo "package_ready=true" >> $GITHUB_OUTPUT
          echo "âœ… Final campaign package created"
          
      - name: Upload Final Package
        uses: actions/upload-artifact@v4
        with:
          name: multimedia-campaign-package-${{ github.run_number }}
          path: generated/final/
          retention-days: 90

      - name: Send Completion Notification
        run: |
          echo "ğŸ“§ Sending completion notification..."
          
          echo "ğŸ‰ Multimedia Ad Campaign Workflow Completed!"
          echo "ğŸ¯ Campaign Objective: ${{ github.event.inputs.campaign_objective }}"
          echo "ğŸ‘¥ Target Audience: ${{ github.event.inputs.target_audience }}"
          echo "ğŸ’° Budget Range: ${{ github.event.inputs.budget_range }}"
          echo "ğŸ¨ Brand Tone: ${{ github.event.inputs.brand_tone }}"
          echo "ğŸ“¢ Channels: ${{ github.event.inputs.channels }}"
          echo "ğŸ¬ Content Focus: ${{ github.event.inputs.content_emphasis }}"
          echo "ğŸ“… Duration: ${{ github.event.inputs.campaign_duration }}"
          echo "ğŸ“¦ Package: multimedia-campaign-package-${{ github.run_number }}"
          echo "ğŸ”— Download: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}"
          echo "âœ… All 8 fine-grained jobs completed successfully"