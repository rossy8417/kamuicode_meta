# ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ãƒ©ã‚¤ãƒ‰åˆ¶ä½œ - è¶…è©³ç´°ã‚¿ã‚¹ã‚¯åˆ†è§£
name: "presentation-slide-creation"
description: "ãƒ†ãƒ¼ãƒžåˆ†æžã‹ã‚‰ã‚¹ãƒ©ã‚¤ãƒ‰ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ»å†…å®¹ä½œæˆã¾ã§åŒ…æ‹¬çš„ãªãƒ—ãƒ¬ã‚¼ãƒ³è³‡æ–™åˆ¶ä½œ"
category: "business-presentation-creation"
complexity_level: 4
estimated_duration_minutes: 40

# äººé–“ã®ç„¡æ„è­˜æ€è€ƒãƒ—ãƒ­ã‚»ã‚¹
human_process:
  - phase: "content_analysis"
    description: "å†…å®¹åˆ†æžæ®µéšŽï¼ˆãƒ†ãƒ¼ãƒžç†è§£ãƒ»å¯¾è±¡è€…åˆ†æžãƒ»æ§‹æˆæ¤œè¨Žï¼‰"
  - phase: "structure_design"
    description: "æ§‹é€ è¨­è¨ˆæ®µéšŽï¼ˆæµã‚Œãƒ»è«–ç†ãƒ»ã‚¹ãƒˆãƒ¼ãƒªãƒ¼æ§‹ç¯‰ï¼‰"
  - phase: "visual_planning"
    description: "ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ä¼ç”»æ®µéšŽï¼ˆãƒ‡ã‚¶ã‚¤ãƒ³æ–¹é‡ãƒ»ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒ»è‰²å½©è¨ˆç”»ï¼‰"
  - phase: "content_creation"
    description: "å†…å®¹åˆ¶ä½œæ®µéšŽï¼ˆå„ã‚¹ãƒ©ã‚¤ãƒ‰ä½œæˆãƒ»ãƒ†ã‚­ã‚¹ãƒˆãƒ»å›³è§£ï¼‰"
  - phase: "design_integration"
    description: "ãƒ‡ã‚¶ã‚¤ãƒ³çµ±åˆæ®µéšŽï¼ˆè¦–è¦šçš„ä¸€è²«æ€§ãƒ»ãƒ–ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ï¼‰"
  - phase: "quality_refinement"
    description: "å“è³ªå‘ä¸Šæ®µéšŽï¼ˆãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»èª¿æ•´ãƒ»æœ€çµ‚åŒ–ï¼‰"

# GitHub Actions ãƒŽãƒ¼ãƒ‰è¨­è¨ˆ
github_actions_config:
  workflow_name: "Presentation Slide Creation Pipeline"
  on_triggers: ["workflow_dispatch", "issues"]
  permissions:
    contents: "write"
    issues: "write"
    actions: "read"
  artifacts_retention_days: 30
  max_parallel_jobs: 4

# è¶…è©³ç´°ã‚¿ã‚¹ã‚¯åˆ†è§£
tasks:
  # === äº‹å‰ãƒ†ã‚¹ãƒˆæ®µéšŽ ===
  - id: "design-services-connectivity-test"
    name: "ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ»ç”Ÿæˆã‚µãƒ¼ãƒ“ã‚¹æŽ¥ç¶šãƒ†ã‚¹ãƒˆ"
    phase: "pre_validation"
    github_job: "connectivity-test"
    type: "validation"
    implementation: "mcp"
    duration_minutes: 3
    dependencies: []
    parallel_group: null
    
    github_steps:
      - name: "Test design and generation services"
        shell: "bash"
        script: |
          echo "ðŸŽ¨ Testing presentation design services..."
          
          mkdir -p .logs/connectivity-tests
          
          # ç”»åƒç”Ÿæˆã‚µãƒ¼ãƒ“ã‚¹ãƒ†ã‚¹ãƒˆï¼ˆã‚¹ãƒ©ã‚¤ãƒ‰èƒŒæ™¯ãƒ»ã‚¢ã‚¤ã‚³ãƒ³ç”¨ï¼‰
          echo "Testing image generation for slide graphics..."
          if timeout 60 claude-code --mcp-config=~/.claude/mcp-kamuicode.json --mcp t2i-fal-imagen4-fast --prompt "business presentation slide background, professional clean design" > .logs/connectivity-tests/image-test.log 2>&1; then
            IMAGE_GEN_STATUS="success"
            echo "âœ… Image Generation (Slide Graphics): Available"
          else
            IMAGE_GEN_STATUS="failed"
            echo "âš ï¸ Image Generation: Not available - will use text-based slides"
          fi
          
          # ç”»åƒå¼·åŒ–ã‚µãƒ¼ãƒ“ã‚¹ãƒ†ã‚¹ãƒˆï¼ˆå“è³ªå‘ä¸Šç”¨ï¼‰
          echo "Testing image enhancement services..."
          if timeout 45 claude-code --mcp-config=~/.claude/mcp-kamuicode.json --mcp i2i-fal-flux-kontext-max --image-path "/tmp/test.jpg" --enhancement "professional presentation quality" > .logs/connectivity-tests/enhancement-test.log 2>&1; then
            IMAGE_ENHANCEMENT_STATUS="success"
            echo "âœ… Image Enhancement: Available"
          else
            IMAGE_ENHANCEMENT_STATUS="failed"
            echo "âš ï¸ Image Enhancement: Not available - basic quality only"
          fi
          
          # Claude Code AI ãƒ†ã‚¹ãƒˆï¼ˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”Ÿæˆç”¨ï¼‰
          echo "Testing Claude Code for content generation..."
          if timeout 30 claude-code --prompt "Test: Create a simple presentation outline for 'Business Strategy'. Return 'CONTENT_TEST_SUCCESS' if working." > .logs/connectivity-tests/content-test.log 2>&1; then
            if grep -q "CONTENT_TEST_SUCCESS" .logs/connectivity-tests/content-test.log; then
              CONTENT_GEN_STATUS="success"
              echo "âœ… Content Generation: Available"
            else
              CONTENT_GEN_STATUS="partial"
              echo "âš ï¸ Content Generation: Partial - response received but format needs adjustment"
            fi
          else
            CONTENT_GEN_STATUS="failed"
            echo "âŒ Content Generation: Failed"
          fi
          
          # å¤–éƒ¨ãƒ‡ã‚¶ã‚¤ãƒ³APIãƒ†ã‚¹ãƒˆï¼ˆCanva APIç­‰ï¼‰
          echo "Testing external design APIs..."
          if [ -n "${{ secrets.CANVA_API_KEY }}" ]; then
            if timeout 30 curl -s -H "Authorization: Bearer ${{ secrets.CANVA_API_KEY }}" "https://api.canva.com/rest/v1/designs" > .logs/connectivity-tests/canva-test.log 2>&1; then
              DESIGN_API_STATUS="success"
              echo "âœ… External Design API: Available"
            else
              DESIGN_API_STATUS="failed"
              echo "âš ï¸ External Design API: Failed - will use generated graphics"
            fi
          else
            DESIGN_API_STATUS="not_configured"
            echo "â„¹ï¸ External Design API: Not configured"
          fi
          
          # Google Slides APIãƒ†ã‚¹ãƒˆï¼ˆæœ€çµ‚å‡ºåŠ›ç”¨ï¼‰
          echo "Testing Google Slides API..."
          if [ -n "${{ secrets.GOOGLE_SLIDES_API_KEY }}" ]; then
            if timeout 30 curl -s "https://slides.googleapis.com/v1/presentations?key=${{ secrets.GOOGLE_SLIDES_API_KEY }}" > .logs/connectivity-tests/gslides-test.log 2>&1; then
              GSLIDES_API_STATUS="success"
              echo "âœ… Google Slides API: Available"
            else
              GSLIDES_API_STATUS="failed"
              echo "âš ï¸ Google Slides API: Failed - will output as static files"
            fi
          else
            GSLIDES_API_STATUS="not_configured"
            echo "â„¹ï¸ Google Slides API: Not configured"
          fi
          
          # ãƒ†ã‚¹ãƒˆçµæžœã‚’JSONä¿å­˜
          cat > .logs/connectivity-tests/test-results.json << EOF
          {
            "timestamp": "$(date -u +%Y-%m-%dT%H:%M:%SZ)",
            "presentation_services": {
              "image_generation": "$IMAGE_GEN_STATUS",
              "image_enhancement": "$IMAGE_ENHANCEMENT_STATUS", 
              "content_generation": "$CONTENT_GEN_STATUS",
              "design_api": "$DESIGN_API_STATUS",
              "google_slides_api": "$GSLIDES_API_STATUS"
            },
            "production_capability": "$([ "$CONTENT_GEN_STATUS" != "failed" ] && echo "full" || echo "limited")",
            "workflow_can_proceed": $([ "$CONTENT_GEN_STATUS" != "failed" ] && echo "true" || echo "false"),
            "enhanced_design": $([ "$IMAGE_GEN_STATUS" = "success" ] && echo "true" || echo "false"),
            "external_integration": $([ "$GSLIDES_API_STATUS" = "success" ] && echo "true" || echo "false")
          }
          EOF
          
          # ç’°å¢ƒå¤‰æ•°ã«çµæžœã‚’è¨­å®š
          echo "PRODUCTION_CAPABILITY=$([ "$CONTENT_GEN_STATUS" != "failed" ] && echo "full" || echo "limited")" >> $GITHUB_ENV
          echo "ENHANCED_DESIGN=$([ "$IMAGE_GEN_STATUS" = "success" ] && echo "true" || echo "false")" >> $GITHUB_ENV
          echo "EXTERNAL_INTEGRATION=$([ "$GSLIDES_API_STATUS" = "success" ] && echo "true" || echo "false")" >> $GITHUB_ENV
          
          echo "ðŸŽ¨ Design services connectivity tests completed"
          
    validation:
      criteria:
        - "ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”Ÿæˆã‚µãƒ¼ãƒ“ã‚¹ãŒåˆ©ç”¨å¯èƒ½"
        - "æœ€ä½Žé™ã®ãƒ‡ã‚¶ã‚¤ãƒ³æ©Ÿèƒ½ãŒåˆ©ç”¨å¯èƒ½"
        - "ãƒ†ã‚¹ãƒˆçµæžœãŒJSONå½¢å¼ã§ä¿å­˜ã•ã‚Œã¦ã„ã‚‹"
      validation_script: |
        if [ ! -f ".logs/connectivity-tests/test-results.json" ]; then
          echo "âŒ VALIDATION FAILED: Test results missing"
          exit 1
        fi
        
        WORKFLOW_CAN_PROCEED=$(jq -r '.workflow_can_proceed' .logs/connectivity-tests/test-results.json)
        if [ "$WORKFLOW_CAN_PROCEED" = "true" ]; then
          echo "âœ… Validation passed: Presentation services ready"
        else
          echo "âŒ VALIDATION FAILED: Critical presentation services unavailable"
          exit 1
        fi

  # === å†…å®¹åˆ†æžæ®µéšŽ ===
  - id: "presentation-topic-analysis"
    name: "ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ãƒžãƒ»å¯¾è±¡è€…åˆ†æž"
    phase: "content_analysis"
    github_job: "topic-analysis"
    type: "analysis"
    implementation: "ai"
    duration_minutes: 4
    dependencies: ["design-services-connectivity-test"]
    parallel_group: null
    
    github_steps:
      - name: "Analyze presentation topic and audience"
        shell: "bash"
        script: |
          echo "ðŸ” Analyzing presentation topic and target audience..."
          
          mkdir -p .logs/content-analysis
          
          # å…¥åŠ›ã‹ã‚‰ãƒ†ãƒ¼ãƒžã¨è¦ä»¶ã‚’æŠ½å‡º
          PRESENTATION_TOPIC="${{ github.event.inputs.presentation_topic || github.event.issue.title || 'Business Presentation' }}"
          TARGET_AUDIENCE="${{ github.event.inputs.target_audience || 'business professionals' }}"
          PRESENTATION_TIME="${{ github.event.inputs.presentation_time || '15 minutes' }}"
          PRESENTATION_STYLE="${{ github.event.inputs.presentation_style || 'professional and engaging' }}"
          PURPOSE="${{ github.event.inputs.purpose || 'inform and persuade' }}"
          
          echo "Topic: $PRESENTATION_TOPIC"
          echo "Audience: $TARGET_AUDIENCE"
          echo "Duration: $PRESENTATION_TIME"
          echo "Style: $PRESENTATION_STYLE"
          echo "Purpose: $PURPOSE"
          
          # Claude Code ã§ãƒ†ãƒ¼ãƒžãƒ»å¯¾è±¡è€…åˆ†æž
          claude-code --prompt "ä»¥ä¸‹ã®ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è¦ä»¶ã‚’è©³ç´°ã«åˆ†æžã—ã¦ãã ã•ã„ï¼š
          
          ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ãƒž: $PRESENTATION_TOPIC
          å¯¾è±¡è¦–è´è€…: $TARGET_AUDIENCE
          ç™ºè¡¨æ™‚é–“: $PRESENTATION_TIME
          ã‚¹ã‚¿ã‚¤ãƒ«: $PRESENTATION_STYLE
          ç›®çš„: $PURPOSE
          
          ä»¥ä¸‹ã®å½¢å¼ã§JSONã§å›žç­”ã—ã¦ãã ã•ã„ï¼š
          {
            \"topic_analysis\": {
              \"main_theme\": \"ä¸»è¦ãƒ†ãƒ¼ãƒž\",
              \"key_concepts\": [\"é‡è¦æ¦‚å¿µã®ãƒªã‚¹ãƒˆ\"],
              \"complexity_level\": \"beginner|intermediate|advanced\",
              \"industry_context\": \"æ¥­ç•Œãƒ»åˆ†é‡Žã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ\",
              \"trending_aspects\": [\"ãƒˆãƒ¬ãƒ³ãƒ‰è¦ç´ \"],
              \"potential_challenges\": [\"æƒ³å®šã•ã‚Œã‚‹èª²é¡Œãƒ»åè«–\"]
            },
            \"audience_analysis\": {
              \"primary_audience\": \"ä¸»è¦å¯¾è±¡è€…\",
              \"knowledge_level\": \"å°‚é–€çŸ¥è­˜ãƒ¬ãƒ™ãƒ«\",
              \"interests_motivations\": [\"é–¢å¿ƒãƒ»å‹•æ©Ÿ\"],
              \"communication_preferences\": \"ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³å¥½ã¿\",
              \"expected_outcomes\": [\"æœŸå¾…ã•ã‚Œã‚‹æˆæžœ\"],
              \"attention_span\": \"é›†ä¸­åŠ›æŒç¶šæ™‚é–“\"
            },
            \"presentation_requirements\": {
              \"estimated_slides\": \"æŽ¨å®šã‚¹ãƒ©ã‚¤ãƒ‰æ•°\",
              \"content_depth\": \"å†…å®¹ã®æ·±ã•\",
              \"visual_emphasis\": \"ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«é‡è¦åº¦ï¼ˆhigh|medium|lowï¼‰\",
              \"interaction_level\": \"è´è¡†ã¨ã®å¯¾è©±ãƒ¬ãƒ™ãƒ«\",
              \"supporting_materials\": [\"å¿…è¦ãªè£œåŠ©è³‡æ–™\"]
            },
            \"success_metrics\": {
              \"primary_objectives\": [\"ä¸»è¦ç›®æ¨™\"],
              \"key_messages\": [\"ä¼ãˆã‚‹ã¹ãé‡è¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸\"],
              \"desired_actions\": [\"è´è¡†ã«æœŸå¾…ã™ã‚‹è¡Œå‹•\"],
              \"measurement_criteria\": [\"æˆåŠŸã®åˆ¤æ–­åŸºæº–\"]
            },
            \"content_strategy\": {
              \"opening_approach\": \"å°Žå…¥æ–¹æ³•\",
              \"narrative_structure\": \"ç‰©èªžæ§‹é€ \",
              \"persuasion_techniques\": [\"èª¬å¾—æŠ€æ³•\"],
              \"engagement_methods\": [\"å‚åŠ ä¿ƒé€²æ–¹æ³•\"]
            }
          }" > .logs/content-analysis/topic-analysis.json
          
          TOPIC_ANALYSIS=$(cat .logs/content-analysis/topic-analysis.json)
          echo "TOPIC_ANALYSIS_FILE=.logs/content-analysis/topic-analysis.json" >> $GITHUB_ENV
          
          # ã‚¹ãƒ©ã‚¤ãƒ‰æ•°ã‚’ç’°å¢ƒå¤‰æ•°ã«è¨­å®š
          ESTIMATED_SLIDES=$(echo "$TOPIC_ANALYSIS" | jq -r '.presentation_requirements.estimated_slides')
          echo "ESTIMATED_SLIDES=$ESTIMATED_SLIDES" >> $GITHUB_ENV
          
          echo "ðŸ” Topic and audience analysis completed"
          echo "Estimated slides: $ESTIMATED_SLIDES"

  - id: "content-structure-planning"
    name: "ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æ§‹é€ ãƒ»æµã‚Œè¨­è¨ˆ"
    phase: "structure_design"
    github_job: "structure-planning"
    type: "planning"
    implementation: "ai"
    duration_minutes: 5
    dependencies: ["presentation-topic-analysis"]
    parallel_group: null
    
    github_steps:
      - name: "Design content structure and flow"
        shell: "bash"
        script: |
          echo "ðŸ“ Designing content structure and presentation flow..."
          
          mkdir -p .logs/structure-design
          
          TOPIC_ANALYSIS=$(cat .logs/content-analysis/topic-analysis.json)
          
          # æ§‹é€ è¨­è¨ˆã¨ã‚¹ãƒ©ã‚¤ãƒ‰è©³ç´°è¨­è¨ˆ
          claude-code --prompt "ä»¥ä¸‹ã®åˆ†æžçµæžœã«åŸºã¥ã„ã¦ã€ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®è©³ç´°ãªæ§‹é€ ã¨ã‚¹ãƒ©ã‚¤ãƒ‰è¨­è¨ˆã‚’è¡Œã£ã¦ãã ã•ã„ï¼š
          
          ãƒ†ãƒ¼ãƒžãƒ»å¯¾è±¡è€…åˆ†æž: $TOPIC_ANALYSIS
          
          ä»¥ä¸‹ã®å½¢å¼ã§JSONã§å›žç­”ã—ã¦ãã ã•ã„ï¼š
          {
            \"presentation_structure\": {
              \"total_slides\": \"ç·ã‚¹ãƒ©ã‚¤ãƒ‰æ•°\",
              \"estimated_duration\": \"æŽ¨å®šç™ºè¡¨æ™‚é–“\",
              \"structure_type\": \"å•é¡Œè§£æ±ºåž‹|æ¯”è¼ƒæ¤œè¨Žåž‹|æ™‚ç³»åˆ—åž‹|ãƒ—ãƒ­ã‚»ã‚¹èª¬æ˜Žåž‹ç­‰\",
              \"flow_strategy\": \"è«–ç†çš„ãªæµã‚Œã®æˆ¦ç•¥\"
            },
            \"slide_sequence\": [
              {
                \"slide_number\": 1,
                \"slide_type\": \"title|agenda|content|transition|conclusion|q_and_a\",
                \"section\": \"æ‰€å±žã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆå°Žå…¥|æœ¬è«–|çµè«–ç­‰ï¼‰\",
                \"title\": \"ã‚¹ãƒ©ã‚¤ãƒ‰ã‚¿ã‚¤ãƒˆãƒ«\",
                \"main_content\": \"ä¸»è¦ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®æ¦‚è¦\",
                \"key_points\": [\"é‡è¦ãƒã‚¤ãƒ³ãƒˆ\"],
                \"visual_elements\": [\"å¿…è¦ãªãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«è¦ç´ \"],
                \"speaker_notes\": \"è©±è€…ç”¨ãƒ¡ãƒ¢\",
                \"estimated_time\": \"ã“ã®ã‚¹ãƒ©ã‚¤ãƒ‰ã®æƒ³å®šæ™‚é–“ï¼ˆåˆ†ï¼‰\",
                \"interaction_points\": [\"è´è¡†ã¨ã®å¯¾è©±ãƒã‚¤ãƒ³ãƒˆ\"],
                \"transition_to_next\": \"æ¬¡ã®ã‚¹ãƒ©ã‚¤ãƒ‰ã¸ã®ç¹‹ãŽæ–¹\"
              }
            ],
            \"visual_consistency\": {
              \"color_scheme\": \"æŽ¨å¥¨ã‚«ãƒ©ãƒ¼ã‚¹ã‚­ãƒ¼ãƒ \",
              \"typography_style\": \"ãƒ•ã‚©ãƒ³ãƒˆãƒ»æ–‡å­—ã‚¹ã‚¿ã‚¤ãƒ«\",
              \"layout_patterns\": [\"ä½¿ç”¨ã™ã‚‹ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³\"],
              \"visual_hierarchy\": \"è¦–è¦šçš„å„ªå…ˆé †ä½ã®æ–¹é‡\",
              \"branding_elements\": [\"ãƒ–ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°è¦ç´ \"]
            },
            \"content_guidelines\": {
              \"text_density\": \"ãƒ†ã‚­ã‚¹ãƒˆå¯†åº¦ã®æ–¹é‡\",
              \"bullet_point_strategy\": \"ç®‡æ¡æ›¸ãã®ä½¿ç”¨æ–¹é‡\",
              \"data_visualization\": [\"ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ–ã®æ–¹é‡\"],
              \"image_usage\": \"ç”»åƒä½¿ç”¨ã®æ–¹é‡\",
              \"consistency_rules\": [\"ä¸€è²«æ€§ã‚’ä¿ã¤ãƒ«ãƒ¼ãƒ«\"]
            },
            \"engagement_strategy\": {
              \"opening_hook\": \"å†’é ­ã§ã®é–¢å¿ƒå–šèµ·æ–¹æ³•\",
              \"mid_point_energizers\": [\"ä¸­ç›¤ã§ã®é›†ä¸­åŠ›ç¶­æŒæ–¹æ³•\"],
              \"closing_impact\": \"å°è±¡çš„ãªçµ‚ã‚ã‚Šæ–¹\",
              \"q_and_a_preparation\": \"è³ªç–‘å¿œç­”ã®æº–å‚™æ–¹é‡\"
            }
          }" > .logs/structure-design/presentation-structure.json
          
          PRESENTATION_STRUCTURE=$(cat .logs/structure-design/presentation-structure.json)
          echo "PRESENTATION_STRUCTURE_FILE=.logs/structure-design/presentation-structure.json" >> $GITHUB_ENV
          
          # ç·ã‚¹ãƒ©ã‚¤ãƒ‰æ•°ã‚’æ›´æ–°
          TOTAL_SLIDES=$(echo "$PRESENTATION_STRUCTURE" | jq -r '.presentation_structure.total_slides')
          echo "TOTAL_SLIDES=$TOTAL_SLIDES" >> $GITHUB_ENV
          
          echo "ðŸ“ Content structure design completed"
          echo "Total slides planned: $TOTAL_SLIDES"

  # === ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ä¼ç”»æ®µéšŽ ===
  - id: "visual-design-planning"
    name: "ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒ‡ã‚¶ã‚¤ãƒ³ä¼ç”»ãƒ»ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè¨­è¨ˆ"
    phase: "visual_planning"
    github_job: "visual-planning"
    type: "design"
    implementation: "ai"
    duration_minutes: 4
    dependencies: ["content-structure-planning"]
    parallel_group: "design_parallel"
    
    github_steps:
      - name: "Plan visual design and create templates"
        shell: "bash"
        script: |
          echo "ðŸŽ¨ Planning visual design and creating templates..."
          
          mkdir -p .logs/visual-planning
          
          TOPIC_ANALYSIS=$(cat .logs/content-analysis/topic-analysis.json)
          PRESENTATION_STRUCTURE=$(cat .logs/structure-design/presentation-structure.json)
          
          # ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒ‡ã‚¶ã‚¤ãƒ³ä¼ç”»
          claude-code --prompt "ä»¥ä¸‹ã®æƒ…å ±ã«åŸºã¥ã„ã¦ã€ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®çµ±ä¸€çš„ãªãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒ‡ã‚¶ã‚¤ãƒ³ã‚’ä¼ç”»ã—ã¦ãã ã•ã„ï¼š
          
          ãƒ†ãƒ¼ãƒžåˆ†æž: $TOPIC_ANALYSIS
          ãƒ—ãƒ¬ã‚¼ãƒ³æ§‹é€ : $PRESENTATION_STRUCTURE
          
          ä»¥ä¸‹ã®å½¢å¼ã§JSONã§å›žç­”ã—ã¦ãã ã•ã„ï¼š
          {
            \"design_concept\": {
              \"overall_theme\": \"å…¨ä½“çš„ãªãƒ‡ã‚¶ã‚¤ãƒ³ãƒ†ãƒ¼ãƒž\",
              \"visual_mood\": \"ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã®é›°å›²æ°—ï¼ˆprofessional|creative|modern|classicç­‰ï¼‰\",
              \"brand_alignment\": \"ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¤ãƒ¡ãƒ¼ã‚¸ã¨ã®æ•´åˆæ€§\",
              \"differentiation_strategy\": \"ä»–ã¨ã®å·®åˆ¥åŒ–æˆ¦ç•¥\"
            },
            \"color_system\": {
              \"primary_colors\": [\"ãƒ¡ã‚¤ãƒ³ã‚«ãƒ©ãƒ¼ï¼ˆHEXã‚³ãƒ¼ãƒ‰ï¼‰\"],
              \"secondary_colors\": [\"ã‚µãƒ–ã‚«ãƒ©ãƒ¼ï¼ˆHEXã‚³ãƒ¼ãƒ‰ï¼‰\"],
              \"accent_colors\": [\"ã‚¢ã‚¯ã‚»ãƒ³ãƒˆã‚«ãƒ©ãƒ¼ï¼ˆHEXã‚³ãƒ¼ãƒ‰ï¼‰\"],
              \"background_colors\": [\"èƒŒæ™¯è‰²ï¼ˆHEXã‚³ãƒ¼ãƒ‰ï¼‰\"],
              \"text_colors\": [\"ãƒ†ã‚­ã‚¹ãƒˆè‰²ï¼ˆHEXã‚³ãƒ¼ãƒ‰ï¼‰\"]
            },
            \"typography_system\": {
              \"heading_fonts\": [\"è¦‹å‡ºã—ç”¨ãƒ•ã‚©ãƒ³ãƒˆ\"],
              \"body_fonts\": [\"æœ¬æ–‡ç”¨ãƒ•ã‚©ãƒ³ãƒˆ\"],
              \"accent_fonts\": [\"ã‚¢ã‚¯ã‚»ãƒ³ãƒˆç”¨ãƒ•ã‚©ãƒ³ãƒˆ\"],
              \"font_sizes\": {
                \"title\": \"ã‚¿ã‚¤ãƒˆãƒ«ã‚µã‚¤ã‚º\",
                \"heading\": \"è¦‹å‡ºã—ã‚µã‚¤ã‚º\",
                \"body\": \"æœ¬æ–‡ã‚µã‚¤ã‚º\",
                \"caption\": \"ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚º\"
              }
            },
            \"layout_templates\": [
              {
                \"template_name\": \"ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå\",
                \"use_case\": \"ä½¿ç”¨å ´é¢\",
                \"layout_description\": \"ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã®èª¬æ˜Ž\",
                \"grid_structure\": \"ã‚°ãƒªãƒƒãƒ‰æ§‹é€ \",
                \"content_areas\": [\"ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ã®å®šç¾©\"],
                \"visual_elements\": [\"å«ã¾ã‚Œã‚‹ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«è¦ç´ \"]
              }
            ],
            \"graphic_elements\": {
              \"icons_style\": \"ã‚¢ã‚¤ã‚³ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«\",
              \"illustration_style\": \"ã‚¤ãƒ©ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚¿ã‚¤ãƒ«\",
              \"photo_treatment\": \"å†™çœŸã®å‡¦ç†æ–¹é‡\",
              \"chart_style\": \"ã‚°ãƒ©ãƒ•ãƒ»ãƒãƒ£ãƒ¼ãƒˆã‚¹ã‚¿ã‚¤ãƒ«\",
              \"decorative_elements\": [\"è£…é£¾è¦ç´ \"]
            },
            \"slide_templates\": [
              {
                \"slide_type\": \"title|content|image|chart|quote|transition\",
                \"template_description\": \"ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®èª¬æ˜Ž\",
                \"layout_specifications\": \"ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆä»•æ§˜\",
                \"image_generation_prompt\": \"èƒŒæ™¯ç”»åƒç”Ÿæˆç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ\",
                \"color_usage\": \"è‰²ã®ä½¿ç”¨æ–¹é‡\",
                \"typography_usage\": \"æ–‡å­—ã®ä½¿ç”¨æ–¹é‡\"
              }
            ]
          }" > .logs/visual-planning/design-plan.json
          
          DESIGN_PLAN=$(cat .logs/visual-planning/design-plan.json)
          echo "DESIGN_PLAN_FILE=.logs/visual-planning/design-plan.json" >> $GITHUB_ENV
          
          echo "ðŸŽ¨ Visual design planning completed"

  - id: "slide-background-generation"
    name: "ã‚¹ãƒ©ã‚¤ãƒ‰èƒŒæ™¯ãƒ»ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ç”Ÿæˆ"
    phase: "visual_planning"
    github_job: "background-generation"
    type: "generation"
    implementation: "mcp"
    tool: "image-generation"
    duration_minutes: 6
    dependencies: ["visual-design-planning"]
    parallel_group: "design_parallel"
    
    github_steps:
      - name: "Generate slide backgrounds and graphics"
        shell: "bash"
        script: |
          echo "ðŸ–¼ï¸ Generating slide backgrounds and graphics..."
          
          mkdir -p .logs/visual-planning/backgrounds
          
          DESIGN_PLAN=$(cat .logs/visual-planning/design-plan.json)
          
          if [ "$ENHANCED_DESIGN" = "true" ]; then
            echo "Generating custom slide backgrounds..."
            
            # ã‚¹ãƒ©ã‚¤ãƒ‰ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”¨èƒŒæ™¯ç”Ÿæˆ
            TEMPLATE_COUNT=$(echo "$DESIGN_PLAN" | jq '.slide_templates | length')
            echo "Generating $TEMPLATE_COUNT template backgrounds..."
            
            for i in $(seq 0 $((TEMPLATE_COUNT - 1))); do
              TEMPLATE_DATA=$(echo "$DESIGN_PLAN" | jq ".slide_templates[$i]")
              SLIDE_TYPE=$(echo "$TEMPLATE_DATA" | jq -r '.slide_type')
              IMAGE_PROMPT=$(echo "$TEMPLATE_DATA" | jq -r '.image_generation_prompt')
              
              if [ "$IMAGE_PROMPT" != "null" ] && [ "$IMAGE_PROMPT" != "" ]; then
                echo "Generating background for $SLIDE_TYPE slide..."
                
                FULL_PROMPT="$IMAGE_PROMPT, professional presentation background, clean design, subtle, high resolution, business appropriate"
                
                if timeout 90 claude-code --mcp-config=~/.claude/mcp-kamuicode.json --mcp t2i-fal-imagen4-fast --prompt "$FULL_PROMPT" > .logs/visual-planning/backgrounds/${SLIDE_TYPE}-background.json 2>&1; then
                  echo "âœ… Background generated for $SLIDE_TYPE"
                else
                  echo "âš ï¸ Background generation failed for $SLIDE_TYPE"
                fi
              fi
            done
            
            # æ±Žç”¨ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯è¦ç´ ç”Ÿæˆ
            echo "Generating generic graphic elements..."
            
            # ã‚¢ã‚¤ã‚³ãƒ³ã‚»ãƒƒãƒˆç”Ÿæˆ
            ICONS_STYLE=$(echo "$DESIGN_PLAN" | jq -r '.graphic_elements.icons_style')
            if timeout 60 claude-code --mcp-config=~/.claude/mcp-kamuicode.json --mcp t2i-fal-imagen4-fast --prompt "business presentation icons set, $ICONS_STYLE style, clean vector design, transparent background" > .logs/visual-planning/backgrounds/icons-set.json 2>&1; then
              echo "âœ… Icon set generated"
            fi
            
            # è£…é£¾è¦ç´ ç”Ÿæˆ
            DECORATIVE_ELEMENTS=$(echo "$DESIGN_PLAN" | jq -r '.graphic_elements.decorative_elements[0] // "geometric patterns"')
            if timeout 60 claude-code --mcp-config=~/.claude/mcp-kamuicode.json --mcp t2i-fal-imagen4-fast --prompt "presentation decorative elements, $DECORATIVE_ELEMENTS, professional, subtle, vector style" > .logs/visual-planning/backgrounds/decorative-elements.json 2>&1; then
              echo "âœ… Decorative elements generated"
            fi
            
            BACKGROUND_GENERATION_STATUS="success"
          else
            echo "âš ï¸ Enhanced design not available - using text-based templates"
            BACKGROUND_GENERATION_STATUS="text_only"
          fi
          
          # ç”Ÿæˆçµæžœãƒ­ã‚°
          GENERATED_FILES=$(ls .logs/visual-planning/backgrounds/*.json 2>/dev/null | wc -l)
          
          cat > .logs/visual-planning/backgrounds/generation-log.json << EOF
          {
            "timestamp": "$(date -u +%Y-%m-%dT%H:%M:%SZ)",
            "background_generation": {
              "status": "$BACKGROUND_GENERATION_STATUS",
              "files_generated": $GENERATED_FILES,
              "enhanced_design_available": "$ENHANCED_DESIGN"
            },
            "generated_assets": [$(ls .logs/visual-planning/backgrounds/*.json 2>/dev/null | sed 's/.*/"&"/' | paste -sd,)]
          }
          EOF
          
          echo "BACKGROUND_GENERATION_STATUS=$BACKGROUND_GENERATION_STATUS" >> $GITHUB_ENV
          
          echo "ðŸ–¼ï¸ Background generation completed: $GENERATED_FILES files"

  # === å†…å®¹åˆ¶ä½œæ®µéšŽ ===
  - id: "individual-slide-content-creation"
    name: "å€‹åˆ¥ã‚¹ãƒ©ã‚¤ãƒ‰å†…å®¹ä½œæˆ"
    phase: "content_creation"
    github_job: "slide-content-creation"
    type: "creation"
    implementation: "ai"
    duration_minutes: 12
    dependencies: ["slide-background-generation"]
    parallel_group: null
    
    github_steps:
      - name: "Create detailed content for each slide"
        shell: "bash"
        script: |
          echo "ðŸ“ Creating detailed content for each slide..."
          
          mkdir -p .logs/content-creation/slides
          
          PRESENTATION_STRUCTURE=$(cat .logs/structure-design/presentation-structure.json)
          DESIGN_PLAN=$(cat .logs/visual-planning/design-plan.json)
          TOPIC_ANALYSIS=$(cat .logs/content-analysis/topic-analysis.json)
          
          # å„ã‚¹ãƒ©ã‚¤ãƒ‰ã®è©³ç´°å†…å®¹ã‚’ä½œæˆ
          SLIDE_COUNT=$(echo "$PRESENTATION_STRUCTURE" | jq '.slide_sequence | length')
          echo "Creating content for $SLIDE_COUNT slides..."
          
          for i in $(seq 0 $((SLIDE_COUNT - 1))); do
            SLIDE_DATA=$(echo "$PRESENTATION_STRUCTURE" | jq ".slide_sequence[$i]")
            SLIDE_NUMBER=$(echo "$SLIDE_DATA" | jq -r '.slide_number')
            SLIDE_TYPE=$(echo "$SLIDE_DATA" | jq -r '.slide_type')
            SLIDE_TITLE=$(echo "$SLIDE_DATA" | jq -r '.title')
            
            echo "Creating content for slide $SLIDE_NUMBER: $SLIDE_TITLE"
            
            # å„ã‚¹ãƒ©ã‚¤ãƒ‰ã®è©³ç´°å†…å®¹ã‚’ç”Ÿæˆ
            claude-code --prompt "ä»¥ä¸‹ã®æƒ…å ±ã«åŸºã¥ã„ã¦ã€ã‚¹ãƒ©ã‚¤ãƒ‰${SLIDE_NUMBER}ã®è©³ç´°ãªå†…å®¹ã‚’ä½œæˆã—ã¦ãã ã•ã„ï¼š
            
            ã‚¹ãƒ©ã‚¤ãƒ‰åŸºæœ¬æƒ…å ±: $SLIDE_DATA
            å…¨ä½“æ§‹é€ : $PRESENTATION_STRUCTURE
            ãƒ‡ã‚¶ã‚¤ãƒ³æ–¹é‡: $DESIGN_PLAN
            ãƒ†ãƒ¼ãƒžåˆ†æž: $TOPIC_ANALYSIS
            
            ä»¥ä¸‹ã®å½¢å¼ã§JSONã§å›žç­”ã—ã¦ãã ã•ã„ï¼š
            {
              \"slide_info\": {
                \"slide_number\": $SLIDE_NUMBER,
                \"slide_type\": \"$SLIDE_TYPE\",
                \"title\": \"$SLIDE_TITLE\",
                \"section\": \"æ‰€å±žã‚»ã‚¯ã‚·ãƒ§ãƒ³\"
              },
              \"content_details\": {
                \"main_headline\": \"ãƒ¡ã‚¤ãƒ³ã®è¦‹å‡ºã—\",
                \"sub_headlines\": [\"ã‚µãƒ–è¦‹å‡ºã—ã®ãƒªã‚¹ãƒˆ\"],
                \"bullet_points\": [\"ç®‡æ¡æ›¸ããƒã‚¤ãƒ³ãƒˆ\"],
                \"body_text\": \"æœ¬æ–‡ãƒ†ã‚­ã‚¹ãƒˆ\",
                \"key_takeaways\": [\"é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ\"],
                \"supporting_data\": [\"è£ä»˜ã‘ãƒ‡ãƒ¼ã‚¿ãƒ»çµ±è¨ˆ\"],
                \"quotes_testimonials\": [\"å¼•ç”¨ãƒ»è¨¼è¨€\"]
              },
              \"visual_elements\": {
                \"background_type\": \"ä½¿ç”¨ã™ã‚‹èƒŒæ™¯ã‚¿ã‚¤ãƒ—\",
                \"images_needed\": [\"å¿…è¦ãªç”»åƒã®èª¬æ˜Ž\"],
                \"charts_graphs\": [\"å¿…è¦ãªã‚°ãƒ©ãƒ•ãƒ»ãƒãƒ£ãƒ¼ãƒˆã®ä»•æ§˜\"],
                \"icons_symbols\": [\"ä½¿ç”¨ã™ã‚‹ã‚¢ã‚¤ã‚³ãƒ³ãƒ»ã‚·ãƒ³ãƒœãƒ«\"],
                \"color_emphasis\": [\"å¼·èª¿ã«ä½¿ã†è‰²ã®æŒ‡å®š\"]
              },
              \"layout_specification\": {
                \"text_layout\": \"ãƒ†ã‚­ã‚¹ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæ–¹é‡\",
                \"visual_hierarchy\": \"è¦–è¦šçš„å„ªå…ˆé †ä½\",
                \"white_space_usage\": \"ä½™ç™½ã®ä½¿ã„æ–¹\",
                \"alignment_strategy\": \"é…ç½®ãƒ»æ•´åˆ—æ–¹é‡\"
              },
              \"speaker_guidance\": {
                \"speaking_notes\": [\"è©±è€…ç”¨è©³ç´°ãƒ¡ãƒ¢\"],
                \"timing_guidance\": \"æ™‚é–“é…åˆ†ã‚¬ã‚¤ãƒ€ãƒ³ã‚¹\",
                \"interaction_cues\": [\"è´è¡†ã¨ã®å¯¾è©±ã®ãã£ã‹ã‘\"],
                \"transition_phrases\": [\"æ¬¡ã‚¹ãƒ©ã‚¤ãƒ‰ã¸ã®ç¹‹ãŽãƒ•ãƒ¬ãƒ¼ã‚º\"]
              },
              \"technical_specs\": {
                \"text_length\": \"ãƒ†ã‚­ã‚¹ãƒˆé‡ã®ç›®å®‰\",
                \"font_usage\": \"ãƒ•ã‚©ãƒ³ãƒˆä½¿ç”¨æŒ‡å®š\",
                \"animation_suggestions\": [\"æŽ¨å¥¨ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³\"],
                \"accessibility_notes\": [\"ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£é…æ…®äº‹é …\"]
              }
            }" > .logs/content-creation/slides/slide-${SLIDE_NUMBER}.json
            
            echo "âœ… Content created for slide $SLIDE_NUMBER"
          done
          
          # å…¨ã‚¹ãƒ©ã‚¤ãƒ‰ã®æ¦‚è¦ä½œæˆ
          claude-code --prompt "ä»¥ä¸‹ã®å€‹åˆ¥ã‚¹ãƒ©ã‚¤ãƒ‰æƒ…å ±ã‚’çµ±åˆã—ã¦ã€ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“ã®æ¦‚è¦ã‚’ä½œæˆã—ã¦ãã ã•ã„ï¼š
          
          $(for file in .logs/content-creation/slides/slide-*.json; do
            echo "$(basename "$file"): $(cat "$file" | jq -r '.slide_info.title // "untitled"')"
          done)
          
          ä»¥ä¸‹ã®å½¢å¼ã§JSONã§å›žç­”ã—ã¦ãã ã•ã„ï¼š
          {
            \"presentation_overview\": {
              \"total_slides\": $SLIDE_COUNT,
              \"estimated_duration\": \"æŽ¨å®šç™ºè¡¨æ™‚é–“\",
              \"content_density\": \"å†…å®¹å¯†åº¦ã®è©•ä¾¡\",
              \"visual_balance\": \"è¦–è¦šãƒãƒ©ãƒ³ã‚¹ã®è©•ä¾¡\"
            },
            \"content_quality\": {
              \"message_clarity\": \"1-10ç‚¹ã§ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ˜Žç¢ºåº¦\",
              \"logical_flow\": \"1-10ç‚¹ã§ã®è«–ç†çš„æµã‚Œ\",
              \"engagement_level\": \"1-10ç‚¹ã§ã®é–¢å¿ƒå–šèµ·åº¦\",
              \"actionability\": \"1-10ç‚¹ã§ã®è¡Œå‹•ä¿ƒé€²åº¦\"
            },
            \"readiness_assessment\": {
              \"content_completeness\": \"ready|needs_revision|major_gaps\",
              \"design_integration\": \"ready|needs_adjustment|major_redesign\",
              \"speaker_preparation\": \"ready|needs_practice|extensive_prep_needed\"
            },
            \"next_steps\": [\"æŽ¨å¥¨ã•ã‚Œã‚‹æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—\"]
          }" > .logs/content-creation/presentation-overview.json
          
          PRESENTATION_OVERVIEW=$(cat .logs/content-creation/presentation-overview.json)
          CONTENT_READINESS=$(echo "$PRESENTATION_OVERVIEW" | jq -r '.readiness_assessment.content_completeness')
          
          echo "CONTENT_READINESS=$CONTENT_READINESS" >> $GITHUB_ENV
          echo "PRESENTATION_OVERVIEW_FILE=.logs/content-creation/presentation-overview.json" >> $GITHUB_ENV
          
          echo "ðŸ“ Individual slide content creation completed"
          echo "Content readiness: $CONTENT_READINESS"

  # === ãƒ‡ã‚¶ã‚¤ãƒ³çµ±åˆæ®µéšŽ ===
  - id: "visual-content-integration"
    name: "ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒ»ã‚³ãƒ³ãƒ†ãƒ³ãƒ„çµ±åˆ"
    phase: "design_integration"
    github_job: "visual-integration"
    type: "integration"
    implementation: "ai"
    duration_minutes: 6
    dependencies: ["individual-slide-content-creation"]
    parallel_group: null
    
    github_steps:
      - name: "Integrate visual design with content"
        shell: "bash"
        script: |
          echo "ðŸŽ¨ Integrating visual design with content..."
          
          mkdir -p .logs/design-integration
          
          DESIGN_PLAN=$(cat .logs/visual-planning/design-plan.json)
          PRESENTATION_OVERVIEW=$(cat .logs/content-creation/presentation-overview.json)
          
          # å„ã‚¹ãƒ©ã‚¤ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’çµ±åˆå‡¦ç†
          echo "Processing slide integration..."
          
          for slide_file in .logs/content-creation/slides/slide-*.json; do
            if [ -f "$slide_file" ]; then
              SLIDE_NUMBER=$(basename "$slide_file" .json | sed 's/slide-//')
              SLIDE_CONTENT=$(cat "$slide_file")
              
              echo "Integrating design for slide $SLIDE_NUMBER..."
              
              # ãƒ‡ã‚¶ã‚¤ãƒ³ã¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®çµ±åˆ
              claude-code --prompt "ä»¥ä¸‹ã®ã‚¹ãƒ©ã‚¤ãƒ‰å†…å®¹ã«ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒ‡ã‚¶ã‚¤ãƒ³ã‚’çµ±åˆã—ã¦ãã ã•ã„ï¼š
              
              ã‚¹ãƒ©ã‚¤ãƒ‰å†…å®¹: $SLIDE_CONTENT
              ãƒ‡ã‚¶ã‚¤ãƒ³æ–¹é‡: $DESIGN_PLAN
              å…¨ä½“æ¦‚è¦: $PRESENTATION_OVERVIEW
              
              ä»¥ä¸‹ã®å½¢å¼ã§JSONã§å›žç­”ã—ã¦ãã ã•ã„ï¼š
              {
                \"integrated_slide\": {
                  \"slide_number\": $SLIDE_NUMBER,
                  \"final_layout\": \"æœ€çµ‚ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆä»•æ§˜\",
                  \"color_application\": \"è‰²å½©é©ç”¨æ–¹é‡\",
                  \"typography_application\": \"æ–‡å­—ãƒ‡ã‚¶ã‚¤ãƒ³é©ç”¨\"
                },
                \"visual_content_mapping\": {
                  \"background_selection\": \"é¸æŠžã•ã‚ŒãŸèƒŒæ™¯\",
                  \"graphic_elements\": [\"ä½¿ç”¨ã™ã‚‹ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯è¦ç´ \"],
                  \"image_placements\": [\"ç”»åƒé…ç½®ã®è©³ç´°\"],
                  \"text_styling\": [\"ãƒ†ã‚­ã‚¹ãƒˆã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°è©³ç´°\"]
                },
                \"quality_check\": {
                  \"visual_hierarchy_score\": \"1-10ç‚¹\",
                  \"readability_score\": \"1-10ç‚¹\",
                  \"aesthetic_appeal\": \"1-10ç‚¹\",
                  \"brand_consistency\": \"1-10ç‚¹\"
                },
                \"output_specification\": {
                  \"slide_format\": \"å‡ºåŠ›å½¢å¼\",
                  \"resolution\": \"è§£åƒåº¦\",
                  \"file_requirements\": [\"ãƒ•ã‚¡ã‚¤ãƒ«è¦ä»¶\"]
                }
              }" > .logs/design-integration/integrated-slide-${SLIDE_NUMBER}.json
            fi
          done
          
          # çµ±åˆå“è³ªã®ç·åˆè©•ä¾¡
          echo "Assessing overall integration quality..."
          
          claude-code --prompt "ä»¥ä¸‹ã®çµ±åˆã•ã‚ŒãŸã‚¹ãƒ©ã‚¤ãƒ‰æƒ…å ±ã‚’åŸºã«ã€ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“ã®ãƒ‡ã‚¶ã‚¤ãƒ³çµ±åˆå“è³ªã‚’è©•ä¾¡ã—ã¦ãã ã•ã„ï¼š
          
          çµ±åˆã‚¹ãƒ©ã‚¤ãƒ‰æƒ…å ±: $(for file in .logs/design-integration/integrated-slide-*.json; do
            echo "$(basename "$file"): $(cat "$file" | jq -r '.quality_check // {}' 2>/dev/null)"
          done)
          
          ä»¥ä¸‹ã®å½¢å¼ã§JSONã§å›žç­”ã—ã¦ãã ã•ã„ï¼š
          {
            \"integration_assessment\": {
              \"overall_visual_consistency\": \"1-10ç‚¹ã§ã®è©•ä¾¡\",
              \"design_content_harmony\": \"1-10ç‚¹ã§ã®è©•ä¾¡\",
              \"professional_appearance\": \"1-10ç‚¹ã§ã®è©•ä¾¡\",
              \"audience_appropriateness\": \"1-10ç‚¹ã§ã®è©•ä¾¡\"
            },
            \"identified_improvements\": [
              {
                \"slide_number\": \"ã‚¹ãƒ©ã‚¤ãƒ‰ç•ªå·\",
                \"issue\": \"å•é¡Œç‚¹\",
                \"suggestion\": \"æ”¹å–„ææ¡ˆ\",
                \"priority\": \"high|medium|low\"
              }
            ],
            \"readiness_status\": {
              \"design_integration\": \"complete|needs_minor_adjustments|major_revision_needed\",
              \"quality_level\": \"professional|acceptable|needs_improvement\",
              \"presentation_ready\": \"ready|almost_ready|not_ready\"
            },
            \"final_specifications\": {
              \"total_integrated_slides\": \"çµ±åˆå®Œäº†ã‚¹ãƒ©ã‚¤ãƒ‰æ•°\",
              \"consistent_design_elements\": [\"ä¸€è²«ã—ãŸãƒ‡ã‚¶ã‚¤ãƒ³è¦ç´ \"],
              \"output_formats\": [\"å‡ºåŠ›å¯èƒ½å½¢å¼\"],
              \"file_size_estimate\": \"æŽ¨å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º\"
            }
          }" > .logs/design-integration/integration-assessment.json
          
          INTEGRATION_ASSESSMENT=$(cat .logs/design-integration/integration-assessment.json)
          INTEGRATION_STATUS=$(echo "$INTEGRATION_ASSESSMENT" | jq -r '.readiness_status.design_integration')
          PRESENTATION_READY=$(echo "$INTEGRATION_ASSESSMENT" | jq -r '.readiness_status.presentation_ready')
          
          echo "INTEGRATION_STATUS=$INTEGRATION_STATUS" >> $GITHUB_ENV
          echo "PRESENTATION_READY=$PRESENTATION_READY" >> $GITHUB_ENV
          echo "INTEGRATION_ASSESSMENT_FILE=.logs/design-integration/integration-assessment.json" >> $GITHUB_ENV
          
          echo "ðŸŽ¨ Visual content integration completed"
          echo "Integration status: $INTEGRATION_STATUS"
          echo "Presentation ready: $PRESENTATION_READY"

  # === å“è³ªå‘ä¸Šæ®µéšŽ ===
  - id: "presentation-quality-review"
    name: "ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å“è³ªãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»æœ€çµ‚èª¿æ•´"
    phase: "quality_refinement"
    github_job: "quality-review"
    type: "validation"
    implementation: "ai"
    duration_minutes: 5
    dependencies: ["visual-content-integration"]
    parallel_group: null
    
    github_steps:
      - name: "Comprehensive quality review and final adjustments"
        shell: "bash"
        script: |
          echo "ðŸ” Conducting comprehensive quality review..."
          
          mkdir -p .logs/quality-review
          
          TOPIC_ANALYSIS=$(cat .logs/content-analysis/topic-analysis.json)
          PRESENTATION_STRUCTURE=$(cat .logs/structure-design/presentation-structure.json)
          PRESENTATION_OVERVIEW=$(cat .logs/content-creation/presentation-overview.json)
          INTEGRATION_ASSESSMENT=$(cat .logs/design-integration/integration-assessment.json)
          
          # åŒ…æ‹¬çš„å“è³ªãƒ¬ãƒ“ãƒ¥ãƒ¼
          claude-code --prompt "ä»¥ä¸‹ã®æƒ…å ±ã‚’ç·åˆã—ã¦ã€ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®åŒ…æ‹¬çš„ãªå“è³ªãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å®Ÿæ–½ã—ã¦ãã ã•ã„ï¼š
          
          åˆæœŸåˆ†æž: $TOPIC_ANALYSIS
          æ§‹é€ è¨­è¨ˆ: $PRESENTATION_STRUCTURE
          å†…å®¹æ¦‚è¦: $PRESENTATION_OVERVIEW
          çµ±åˆè©•ä¾¡: $INTEGRATION_ASSESSMENT
          
          ä»¥ä¸‹ã®å½¢å¼ã§JSONã§å›žç­”ã—ã¦ãã ã•ã„ï¼š
          {
            \"comprehensive_review\": {
              \"content_quality\": {
                \"message_clarity\": \"1-10ç‚¹\",
                \"logical_coherence\": \"1-10ç‚¹\",
                \"audience_relevance\": \"1-10ç‚¹\",
                \"actionable_insights\": \"1-10ç‚¹\",
                \"supporting_evidence\": \"1-10ç‚¹\"
              },
              \"design_quality\": {
                \"visual_appeal\": \"1-10ç‚¹\",
                \"consistency\": \"1-10ç‚¹\",
                \"readability\": \"1-10ç‚¹\",
                \"professional_appearance\": \"1-10ç‚¹\",
                \"brand_alignment\": \"1-10ç‚¹\"
              },
              \"structure_quality\": {
                \"logical_flow\": \"1-10ç‚¹\",
                \"pacing\": \"1-10ç‚¹\",
                \"transitions\": \"1-10ç‚¹\",
                \"engagement_maintenance\": \"1-10ç‚¹\",
                \"conclusion_strength\": \"1-10ç‚¹\"
              },
              \"technical_quality\": {
                \"slide_count_appropriateness\": \"1-10ç‚¹\",
                \"text_density\": \"1-10ç‚¹\",
                \"visual_balance\": \"1-10ç‚¹\",
                \"accessibility\": \"1-10ç‚¹\",
                \"format_compliance\": \"1-10ç‚¹\"
              }
            },
            \"improvement_recommendations\": [
              {
                \"category\": \"content|design|structure|technical\",
                \"priority\": \"critical|high|medium|low\",
                \"issue_description\": \"å•é¡Œã®è©³ç´°\",
                \"recommended_action\": \"æŽ¨å¥¨ã•ã‚Œã‚‹å¯¾å¿œ\",
                \"implementation_effort\": \"low|medium|high\",
                \"impact_potential\": \"high|medium|low\"
              }
            ],
            \"final_assessment\": {
              \"overall_quality_score\": \"1-100ç‚¹ã§ã®ç·åˆè©•ä¾¡\",
              \"readiness_level\": \"ready_to_present|minor_revisions_needed|major_revisions_needed\",
              \"strength_areas\": [\"å¼·ã¿ã®ã‚ã‚‹é ˜åŸŸ\"],
              \"improvement_areas\": [\"æ”¹å–„ãŒå¿…è¦ãªé ˜åŸŸ\"],
              \"competitive_advantage\": [\"ç«¶åˆå„ªä½æ€§\"],
              \"risk_factors\": [\"æ½œåœ¨çš„ãƒªã‚¹ã‚¯è¦å› \"]
            },
            \"presentation_guidance\": {
              \"speaker_preparation_time\": \"æŽ¨å¥¨æº–å‚™æ™‚é–“\",
              \"key_practice_points\": [\"ç·´ç¿’ã™ã¹ããƒã‚¤ãƒ³ãƒˆ\"],
              \"audience_interaction_tips\": [\"è´è¡†å¯¾å¿œã®ã‚³ãƒ„\"],
              \"technical_setup_requirements\": [\"æŠ€è¡“çš„æº–å‚™è¦ä»¶\"],
              \"backup_plans\": [\"ç·Šæ€¥æ™‚å¯¾å¿œãƒ—ãƒ©ãƒ³\"]
            },
            \"distribution_recommendations\": {
              \"optimal_delivery_formats\": [\"æŽ¨å¥¨é…ä¿¡å½¢å¼\"],
              \"platform_specific_adjustments\": [\"ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ åˆ¥èª¿æ•´\"],
              \"follow_up_materials\": [\"ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—è³‡æ–™\"],
              \"measurement_metrics\": [\"åŠ¹æžœæ¸¬å®šæŒ‡æ¨™\"]
            }
          }" > .logs/quality-review/comprehensive-review.json
          
          COMPREHENSIVE_REVIEW=$(cat .logs/quality-review/comprehensive-review.json)
          OVERALL_QUALITY=$(echo "$COMPREHENSIVE_REVIEW" | jq -r '.final_assessment.overall_quality_score')
          READINESS_LEVEL=$(echo "$COMPREHENSIVE_REVIEW" | jq -r '.final_assessment.readiness_level')
          
          echo "OVERALL_QUALITY=$OVERALL_QUALITY" >> $GITHUB_ENV
          echo "READINESS_LEVEL=$READINESS_LEVEL" >> $GITHUB_ENV
          echo "COMPREHENSIVE_REVIEW_FILE=.logs/quality-review/comprehensive-review.json" >> $GITHUB_ENV
          
          echo "ðŸ” Quality review completed"
          echo "Overall quality score: $OVERALL_QUALITY/100"
          echo "Readiness level: $READINESS_LEVEL"

  - id: "final-presentation-packaging"
    name: "æœ€çµ‚ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³é…ä¿¡ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä½œæˆ"
    phase: "quality_refinement"
    github_job: "final-packaging"
    type: "packaging"
    implementation: "script"
    duration_minutes: 4
    dependencies: ["presentation-quality-review"]
    parallel_group: null
    
    github_steps:
      - name: "Create comprehensive presentation delivery package"
        shell: "bash"
        script: |
          echo "ðŸ“¦ Creating final presentation delivery package..."
          
          mkdir -p .final-output
          
          # é‡è¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æœ€çµ‚å‡ºåŠ›ã«åŽé›†
          cp .logs/content-analysis/topic-analysis.json .final-output/ 2>/dev/null || true
          cp .logs/structure-design/presentation-structure.json .final-output/ 2>/dev/null || true
          cp .logs/visual-planning/design-plan.json .final-output/ 2>/dev/null || true
          cp .logs/content-creation/presentation-overview.json .final-output/ 2>/dev/null || true
          cp .logs/design-integration/integration-assessment.json .final-output/ 2>/dev/null || true
          cp .logs/quality-review/comprehensive-review.json .final-output/ 2>/dev/null || true
          
          # å€‹åˆ¥ã‚¹ãƒ©ã‚¤ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã¾ã¨ã‚ã‚‹
          mkdir -p .final-output/slides
          cp .logs/content-creation/slides/slide-*.json .final-output/slides/ 2>/dev/null || true
          cp .logs/design-integration/integrated-slide-*.json .final-output/slides/ 2>/dev/null || true
          
          # ç”Ÿæˆã•ã‚ŒãŸãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ç´ æ
          mkdir -p .final-output/visual-assets
          cp .logs/visual-planning/backgrounds/*.json .final-output/visual-assets/ 2>/dev/null || true
          
          # ãƒžã‚¹ã‚¿ãƒ¼é…ä¿¡æƒ…å ±ã®ä½œæˆ
          cat > .final-output/presentation-delivery-package.json << EOF
          {
            "project_info": {
              "project_name": "Presentation Slide Creation",
              "created_at": "$(date -u +%Y-%m-%dT%H:%M:%SZ)",
              "github_run_id": "${{ github.run_id }}",
              "production_capability": "$PRODUCTION_CAPABILITY",
              "total_slides": $TOTAL_SLIDES,
              "estimated_duration": "40 minutes production time"
            },
            "deliverables": {
              "presentation_analysis": "topic-analysis.json",
              "structure_design": "presentation-structure.json",
              "visual_design_plan": "design-plan.json",
              "content_overview": "presentation-overview.json",
              "integration_assessment": "integration-assessment.json",
              "quality_review": "comprehensive-review.json",
              "individual_slides": "slides/",
              "visual_assets": "visual-assets/"
            },
            "presentation_specs": {
              "total_slides": $TOTAL_SLIDES,
              "estimated_presentation_time": "$(echo "$COMPREHENSIVE_REVIEW" | jq -r '.presentation_guidance.speaker_preparation_time // "15-20 minutes"' 2>/dev/null)",
              "quality_score": "$OVERALL_QUALITY/100",
              "readiness_level": "$READINESS_LEVEL",
              "design_enhanced": "$ENHANCED_DESIGN",
              "external_integration": "$EXTERNAL_INTEGRATION"
            },
            "usage_instructions": {
              "speaker_preparation": $(echo "$COMPREHENSIVE_REVIEW" | jq '.presentation_guidance' 2>/dev/null || echo '{}'),
              "technical_requirements": [
                "Presentation software (PowerPoint, Google Slides, etc.)",
                "Display device with appropriate resolution",
                "Backup devices for redundancy",
                "Remote or clicker for navigation"
              ],
              "customization_notes": [
                "Colors can be adjusted for brand alignment",
                "Content can be modified for specific audiences",
                "Additional slides can be added using provided templates",
                "Speaker notes are included for each slide"
              ]
            },
            "quality_metrics": $(echo "$COMPREHENSIVE_REVIEW" | jq '.final_assessment' 2>/dev/null || echo '{}'),
            "next_steps": [
              "Review all slide content for accuracy",
              "Practice presentation timing",
              "Prepare for audience Q&A",
              "Set up technical equipment",
              "Create backup presentation formats"
            ],
            "support_information": {
              "modification_guidance": "Use provided JSON files to understand structure and regenerate if needed",
              "troubleshooting": "Check logs/ directory for detailed generation information",
              "enhancement_options": "Additional visual elements can be generated using MCP services"
            }
          }
          EOF
          
          # ç°¡æ˜“ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œã‚¬ã‚¤ãƒ‰ä½œæˆ
          cat > .final-output/PRESENTATION_GUIDE.md << 'EOF'
          # ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œã‚¬ã‚¤ãƒ‰
          
          ## ðŸ“‹ äº‹å‰æº–å‚™
          - [ ] å…¨ã‚¹ãƒ©ã‚¤ãƒ‰å†…å®¹ã®ç¢ºèª
          - [ ] ç™ºè¡¨ç·´ç¿’ï¼ˆæŽ¨å¥¨3å›žä»¥ä¸Šï¼‰
          - [ ] æŠ€è¡“æ©Ÿå™¨ã®ãƒ†ã‚¹ãƒˆ
          - [ ] ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã®æº–å‚™
          
          ## ðŸŽ¯ ç™ºè¡¨ã®ãƒã‚¤ãƒ³ãƒˆ
          - å„ã‚¹ãƒ©ã‚¤ãƒ‰ã®æŽ¨å¥¨æ™‚é–“ã‚’å®ˆã‚‹
          - è´è¡†ã¨ã®å¯¾è©±ã‚’æ„è­˜ã™ã‚‹
          - é‡è¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å¼·èª¿ã™ã‚‹
          - è³ªç–‘å¿œç­”ã®æº–å‚™ã‚’ã—ã¦ãŠã
          
          ## ðŸ”§ æŠ€è¡“çš„æ³¨æ„äº‹é …
          - è§£åƒåº¦ã®ç¢ºèª
          - ãƒ•ã‚©ãƒ³ãƒˆã®äº’æ›æ€§ãƒã‚§ãƒƒã‚¯
          - ç”»åƒè¡¨ç¤ºã®ç¢ºèª
          - ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å‹•ä½œãƒ†ã‚¹ãƒˆ
          
          ## ðŸ“Š æˆæžœæ¸¬å®š
          - è´è¡†ã®åå¿œã‚’ãƒ¢ãƒ‹ã‚¿ãƒ¼
          - è³ªå•ã®è³ªã¨é‡ã‚’è¨˜éŒ²
          - ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’åŽé›†
          - æ¬¡å›žã¸ã®æ”¹å–„ç‚¹ã‚’è¨˜éŒ²
          EOF
          
          # ZIPãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä½œæˆ
          cd .final-output && zip -r ../presentation-package.zip . && cd ..
          
          echo "ðŸ“¦ Final presentation packaging completed"
          echo "Package includes:"
          echo "- $TOTAL_SLIDES slide specifications"
          echo "- Design plans and visual assets"
          echo "- Quality review (score: $OVERALL_QUALITY/100)"
          echo "- Speaker guidance and setup instructions"
          echo "Package location: presentation-package.zip"
          
    success_links:
      package_download: "${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}/artifacts"
      quality_review: "${{ github.server_url }}/${{ github.repository }}/blob/main/.final-output/comprehensive-review.json"
      design_plan: "${{ github.server_url }}/${{ github.repository }}/blob/main/.final-output/design-plan.json"
      presentation_guide: "${{ github.server_url }}/${{ github.repository }}/blob/main/.final-output/PRESENTATION_GUIDE.md"

    validation:
      criteria:
        - "å…¨ã‚¹ãƒ©ã‚¤ãƒ‰ã®å†…å®¹ãŒä½œæˆã•ã‚Œã¦ã„ã‚‹"
        - "ãƒ‡ã‚¶ã‚¤ãƒ³çµ±åˆãŒå®Œäº†ã—ã¦ã„ã‚‹"
        - "å“è³ªãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒå®Ÿæ–½ã•ã‚Œã¦ã„ã‚‹"
        - "é…ä¿¡ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒä½œæˆã•ã‚Œã¦ã„ã‚‹"
      validation_script: |
        if [ ! -f ".final-output/presentation-delivery-package.json" ]; then
          echo "âŒ VALIDATION FAILED: Delivery package missing"
          exit 1
        fi
        
        if [ "$READINESS_LEVEL" = "ready_to_present" ]; then
          echo "âœ… Validation passed: Presentation ready for delivery"
        elif [ "$READINESS_LEVEL" = "minor_revisions_needed" ]; then
          echo "âš ï¸ WARNING: Minor revisions recommended before presentation"
        else
          echo "âŒ VALIDATION FAILED: Major revisions needed before presentation"
          exit 1
        fi