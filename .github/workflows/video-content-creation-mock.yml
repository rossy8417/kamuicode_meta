name: "Video Content Creation Mock Test"
run-name: "🎥 Mock Test: ${{ github.event.inputs.video_concept || 'Video Production' }}"

on:
  workflow_dispatch:
    inputs:
      video_concept:
        description: '動画コンセプト・テーマ'
        required: true
        default: 'Mock test for video creation workflow'
        type: string

permissions:
  contents: write
  issues: read
  actions: read

jobs:
  mock-test:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        
      - name: Setup directories
        run: |
          echo "📁 Setting up test directories..."
          mkdir -p test-output/{images,audio,video,final}
          
      - name: Mock Image Generation
        run: |
          echo "🎨 Generating mock images..."
          
          # Mock image URLs (using placeholder images)
          echo '{
            "intro_image": "https://via.placeholder.com/1920x1080/FF6B6B/FFFFFF?text=Intro+Scene",
            "main_image": "https://via.placeholder.com/1920x1080/4ECDC4/FFFFFF?text=Main+Content",
            "outro_image": "https://via.placeholder.com/1920x1080/45B7D1/FFFFFF?text=Outro+Scene",
            "service": "mock-t2i",
            "status": "success"
          }' > test-output/images/generated-images.json
          
          echo "✅ Mock images generated"
          
      - name: Mock Audio Generation
        run: |
          echo "🎵 Generating mock audio..."
          
          # Mock audio URL
          echo '{
            "audio_url": "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3",
            "duration": 30,
            "service": "mock-t2m",
            "status": "success"
          }' > test-output/audio/background-music.json
          
          echo "✅ Mock audio generated"
          
      - name: Mock Video Generation
        run: |
          echo "🎬 Generating mock video..."
          
          # Mock video URL
          echo '{
            "video_url": "https://test-videos.co.uk/vids/bigbuckbunny/mp4/h264/1080/Big_Buck_Bunny_1080_10s_1MB.mp4",
            "duration": 10,
            "resolution": "1920x1080",
            "service": "mock-i2v",
            "status": "success"
          }' > test-output/video/main-video.json
          
          echo "✅ Mock video generated"
          
      - name: Create Final Package
        run: |
          echo "📦 Creating final package..."
          
          # Combine all results
          echo '{
            "project": "Mock Video Content Creation Test",
            "concept": "${{ github.event.inputs.video_concept }}",
            "components": {
              "images": "generated-images.json",
              "audio": "background-music.json",
              "video": "main-video.json"
            },
            "status": "success",
            "timestamp": "'$(date -u +%Y-%m-%dT%H:%M:%SZ)'"
          }' > test-output/final/package.json
          
          echo "✅ Final package created"
          
      - name: Display Results
        run: |
          echo "📊 Test Results:"
          echo "==============="
          echo "Images:"
          cat test-output/images/generated-images.json | jq .
          echo ""
          echo "Audio:"
          cat test-output/audio/background-music.json | jq .
          echo ""
          echo "Video:"
          cat test-output/video/main-video.json | jq .
          echo ""
          echo "Final Package:"
          cat test-output/final/package.json | jq .
          
      - name: Upload Test Results
        uses: actions/upload-artifact@v4
        with:
          name: mock-test-results-${{ github.run_number }}
          path: test-output/
          retention-days: 7